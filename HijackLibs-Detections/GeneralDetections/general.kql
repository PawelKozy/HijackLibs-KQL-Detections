DeviceImageLoadEvents
| where tolower(FileName) == "acrodistdll.dll" and (tolower(FolderPath) !contains "c:\program files\adobe\acrobat \acrobat" and tolower(InitiatingProcessFileName) endswith "acrodist.exe")
| where tolower(FileName) == "vender.dll" and (tolower(FolderPath) !contains "c:\program files\asus\gpu tweakii" and tolower(FolderPath) !contains "c:\program files\asus\vga com\" and tolower(InitiatingProcessFileName) endswith "asusgpufanservice.exe")
| where tolower(FileName) == "wsc.dll" and (tolower(FolderPath) !contains "c:\program files\avast software\avast")
| where tolower(FileName) == "basicnetutils.dll" and (tolower(FolderPath) !contains "appdata\local\temp\\application2" and tolower(FolderPath) !contains "c:\program files\baidu\baidupinyin\" and tolower(InitiatingProcessFileName) endswith "xlgameupdate.exe")
| where tolower(FileName) == "log.dll" and (tolower(FolderPath) !contains "c:\program files\bitdefender antivirus free" and tolower(InitiatingProcessFileName) endswith "bdreinit.exe")
| where tolower(FileName) == "ciscosparklauncher.dll" and (tolower(FolderPath) !contains "appdata\local\ciscosparklauncher" and tolower(InitiatingProcessFileName) endswith "ciscocollabhost.exe")
| where tolower(FileName) == "classicexplorer32.dll" and (tolower(FolderPath) !contains "c:\program files\classic shell" and tolower(FolderPath) !contains "c:\program files\open-shell" and tolower(InitiatingProcessFileName) endswith "classicexplorersettings.exe")
| where tolower(FileName) == "vftrace.dll" and (tolower(FolderPath) !contains "c:\program files\cyberark\endpoint privilege manager\agent\x32" and tolower(FolderPath) !contains "c:\program files\cyberark\endpoint privilege manager\agent\x64" and tolower(FolderPath) !contains "c:\program files\cyberark\endpoint privilege manager\agent" and tolower(InitiatingProcessFileName) endswith "vf_host.exe")
| where tolower(FileName) == "qrt.dll" and (tolower(FolderPath) !contains "c:\program files\f-secure\anti-virus" and tolower(InitiatingProcessFileName) endswith "qrtfix.exe")
| where tolower(FileName) == "chrome_frame_helper.dll" and (tolower(FolderPath) !contains "appdata\local\google\chrome\application" and tolower(FolderPath) !contains "c:\program files\google\chrome\application" and tolower(InitiatingProcessFileName) endswith "chrome_frame_helper.exe")
| where tolower(FileName) == "hpcustpartui.dll" and (tolower(FolderPath) !contains "c:\program files\hp" and tolower(InitiatingProcessFileName) endswith "hpcustparticui.exe")
| where tolower(FileName) == "hpqhvsei.dll" and (tolower(FolderPath) !contains "c:\program files\hp" and tolower(InitiatingProcessFileName) endswith "hpqhvind.exe")
| where tolower(FileName) == "commfunc.dll" and (tolower(FolderPath) !contains "c:\program files\lenovo\communications utility" and tolower(InitiatingProcessFileName) endswith "cammute.exe")
| where tolower(FileName) == "lmiguardiandll.dll" and (tolower(FolderPath) !contains "c:\program files\logmein" and tolower(FolderPath) !contains "c:\program files\logmein\x86" and tolower(FolderPath) !contains "c:\program files\logmein\x64" and tolower(InitiatingProcessFileName) endswith "lmiguardiansvc.exe")
| where tolower(FileName) == "facesdk.dll" and (tolower(FolderPath) !contains "c:\program files\luxand\facesdk\bin\win64" and tolower(InitiatingProcessFileName) endswith "facialfeaturedemo.exe")
| where tolower(FileName) == "ashldres.dll" and (tolower(FolderPath) !contains "c:\program files\mcafee.com\vso" and tolower(InitiatingProcessFileName) endswith "mcvsshld.exe")
| where tolower(FileName) == "lockdown.dll" and (tolower(FolderPath) !contains "c:\program files\mcafee\virusscan enterprise" and tolower(InitiatingProcessFileName) endswith "mfeann.exe")
| where tolower(FileName) == "siteadv.dll" and (tolower(FolderPath) !contains "c:\program files\siteadvisor\" and tolower(InitiatingProcessFileName) endswith "sideadv.exe")
| where tolower(FileName) == "vsodscpl.dll" and (tolower(FolderPath) !contains "c:\program files\mcafee\virusscan enterprise" and tolower(InitiatingProcessFileName) endswith "scncfg32.exe")
| where tolower(FileName) == "mozglue.dll" and (tolower(FolderPath) !contains "c:\program files\seamonkey" and tolower(FolderPath) !contains "c:\program files\mozilla firefox" and tolower(FolderPath) !contains "c:\program files\mozilla thunderbird" and tolower(InitiatingProcessFileName) endswith "seamonkey.exe")
| where tolower(FileName) == "nvsmartmax.dll" and (tolower(FolderPath) !contains "c:\program files\nvidia corporation\display" and tolower(InitiatingProcessFileName) endswith "nvsmartex.exe")
| where tolower(FileName) == "opera_elf.dll" and (tolower(FolderPath) !contains "appdata\local\programs\opera\" and tolower(InitiatingProcessFileName) endswith "opera.exe")
| where tolower(FileName) == "winutils.dll" and (tolower(FolderPath) !contains "c:\program files\palo alto networks\traps" and tolower(InitiatingProcessFileName) endswith "cydump.exe")
| where tolower(FileName) == "python39.dll" and (tolower(FolderPath) !contains "c:\program files\python39" and tolower(FolderPath) !contains "appdata\local\temp\" and tolower(FolderPath) !contains "c:\program files\microsoft visual studio\2022\community\common7\ide\commonextensions\microsoft\vc\securityissueanalysis\python" and tolower(FolderPath) !contains "%userprofile%\anaconda3" and tolower(InitiatingProcessFileName) endswith "python39.exe")
| where tolower(FileName) == "rzlog4cpp_logger.dll" and (tolower(FolderPath) !contains "appdata\local\razer\ingameengine\cache\rzfpsapplet" and tolower(InitiatingProcessFileName) endswith "rzcefrenderprocess.exe")
| where tolower(FileName) == "smadhook32c.dll" and (tolower(FolderPath) !contains "c:\program files\smadav" and tolower(InitiatingProcessFileName) endswith "smadhook.exe")
| where tolower(FileName) == "safestore32.dll" and (tolower(FolderPath) !contains "c:\program files\sophos\sophos anti-virus" and tolower(InitiatingProcessFileName) endswith "ssr32.exe")
| where tolower(FileName) == "ldvpocx.ocx" and (tolower(FolderPath) !contains "c:\program files\symantec_client_security\symantec antivirus" and tolower(FolderPath) !contains "c:\program files\symantec antivirus" and tolower(InitiatingProcessFileName) endswith "ldvpreg.exe")
| where tolower(FileName) == "rastls.dll" and (tolower(FolderPath) !contains "c:\program files\symantec\network connected devices auto setup" and tolower(InitiatingProcessFileName) endswith "rastlsc.exe")
| where tolower(FileName) == "shellsel.ocx" and (tolower(InitiatingProcessFileName) endswith "symantec.exe")
| where tolower(FileName) == "tosbtkbd.dll" and (tolower(FolderPath) !contains "c:\program files\toshiba\bluetooth toshiba stack" and tolower(InitiatingProcessFileName) endswith "tosbtkbd.exe")
| where tolower(FileName) == "tmdbglog.dll" and (tolower(FolderPath) !contains "c:\program files\trend micro\titanium" and tolower(InitiatingProcessFileName) endswith "ptwatchdog.exe")
| where tolower(FileName) == "unityplayer.dll" and (tolower(FolderPath) !contains "appdata\local\temp\\windows" and tolower(InitiatingProcessFileName) endswith "kingdomtwocrowns.exe")
| where tolower(FileName) == "vntfxf32.dll" and (tolower(FolderPath) !contains "c:\program files\venta\ventafax & voice" and tolower(InitiatingProcessFileName) endswith "spoololk.exe")
| where tolower(FileName) == "vivaldi_elf.dll" and (tolower(FolderPath) !contains "appdata\local\vivaldi\application" and tolower(FolderPath) !contains "appdata\local\vivaldi\application\" and tolower(InitiatingProcessFileName) endswith "vivaldi.exe")
| where tolower(FileName) == "libvlc.dll" and (tolower(FolderPath) !contains "c:\program files\videolan\vlc" and tolower(InitiatingProcessFileName) endswith "vlc.exe")
| where tolower(FileName) == "glib-2.0.dll" and (tolower(FolderPath) !contains "c:\program files\vmware\vmware tools" and tolower(FolderPath) !contains "c:\program files\vmware\vmware workstation" and tolower(FolderPath) !contains "c:\program files\vmware\vmware player" and tolower(InitiatingProcessFileName) endswith "vmwarexferlogs.exe")
| where tolower(FileName) == "shfolder.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "vmnat.exe")
| where tolower(FileName) == "x32bridge.dll" and (tolower(InitiatingProcessFileName) endswith "x32dbg.exe")
| where tolower(FileName) == "aclui.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "shrpubw.exe" and tolower(InitiatingProcessFileName) endswith "oleview.exe")
| where tolower(FileName) == "activeds.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "applysettingstemplatecatalog.exe" and tolower(InitiatingProcessFileName) endswith "agentservice.exe" and tolower(InitiatingProcessFileName) endswith "dsadd.exe" and tolower(InitiatingProcessFileName) endswith "dsget.exe" and tolower(InitiatingProcessFileName) endswith "dsmod.exe" and tolower(InitiatingProcessFileName) endswith "dsrm.exe" and tolower(InitiatingProcessFileName) endswith "gpfixup.exe")
| where tolower(FileName) == "adsldpc.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "agentservice.exe" and tolower(InitiatingProcessFileName) endswith "netsh.exe" and tolower(InitiatingProcessFileName) endswith "sppextcomobj.exe")
| where tolower(FileName) == "aepic.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "psr.exe")
| where tolower(FileName) == "apphelp.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "compmgmtlauncher.exe" and tolower(InitiatingProcessFileName) endswith "sdbinst.exe")
| where tolower(FileName) == "applicationframe.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "appvpolicy.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(InitiatingProcessFileName) endswith "appvclient.exe")
| where tolower(FileName) == "appwiz.cpl" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "fondue.exe")
| where tolower(FileName) == "appxalluserstore.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "lpremove.exe")
| where tolower(FileName) == "appxdeploymentclient.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "lpremove.exe" and tolower(InitiatingProcessFileName) endswith "systemsettingsadminflows.exe")
| where tolower(FileName) == "archiveint.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "tar.exe")
| where tolower(FileName) == "atl.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "dsquery.exe" and tolower(InitiatingProcessFileName) endswith "filescrn.exe" and tolower(InitiatingProcessFileName) endswith "msconfig.exe" and tolower(InitiatingProcessFileName) endswith "msdt.exe" and tolower(InitiatingProcessFileName) endswith "msinfo32.exe" and tolower(InitiatingProcessFileName) endswith "perfmon.exe" and tolower(InitiatingProcessFileName) endswith "quickassist.exe" and tolower(InitiatingProcessFileName) endswith "storrept.exe" and tolower(InitiatingProcessFileName) endswith "vds.exe" and tolower(InitiatingProcessFileName) endswith "vdsldr.exe" and tolower(InitiatingProcessFileName) endswith "vssadmin.exe" and tolower(InitiatingProcessFileName) endswith "wfs.exe")
| where tolower(FileName) == "audioses.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "osk.exe")
| where tolower(FileName) == "auditpolcore.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "auditpol.exe")
| where tolower(FileName) == "authfwcfg.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "netsh.exe")
| where tolower(FileName) == "authz.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "easinvoker.exe" and tolower(InitiatingProcessFileName) endswith "vssvc.exe" and tolower(InitiatingProcessFileName) endswith "whoami.exe")
| where tolower(FileName) == "avrt.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "osk.exe")
| where tolower(FileName) == "batmeter.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "mblctr.exe")
| where tolower(FileName) == "bcd.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "bootim.exe" and tolower(InitiatingProcessFileName) endswith "cidiag.exe" and tolower(InitiatingProcessFileName) endswith "genvalobj.exe" and tolower(InitiatingProcessFileName) endswith "mdsched.exe" and tolower(InitiatingProcessFileName) endswith "msconfig.exe" and tolower(InitiatingProcessFileName) endswith "recdisc.exe" and tolower(InitiatingProcessFileName) endswith "recoverydrive.exe" and tolower(InitiatingProcessFileName) endswith "resetengine.exe" and tolower(InitiatingProcessFileName) endswith "rstrui.exe" and tolower(InitiatingProcessFileName) endswith "sdclt.exe" and tolower(InitiatingProcessFileName) endswith "srtasks.exe" and tolower(InitiatingProcessFileName) endswith "systempropertiesadvanced.exe" and tolower(InitiatingProcessFileName) endswith "systempropertiescomputername.exe" and tolower(InitiatingProcessFileName) endswith "systempropertiesdataexecutionprevention.exe" and tolower(InitiatingProcessFileName) endswith "systempropertieshardware.exe" and tolower(InitiatingProcessFileName) endswith "systempropertiesprotection.exe" and tolower(InitiatingProcessFileName) endswith "systempropertiesremote.exe" and tolower(InitiatingProcessFileName) endswith "systemreset.exe" and tolower(InitiatingProcessFileName) endswith "vds.exe" and tolower(InitiatingProcessFileName) endswith "vdsldr.exe" and tolower(InitiatingProcessFileName) endswith "vssvc.exe" and tolower(InitiatingProcessFileName) endswith "wbengine.exe")
| where tolower(FileName) == "bcp47langs.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "lpremove.exe" and tolower(InitiatingProcessFileName) endswith "systemsettingsadminflows.exe")
| where tolower(FileName) == "bcp47mrm.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "mcbuilder.exe")
| where tolower(FileName) == "bcrypt.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "bderepair.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(InitiatingProcessFileName) endswith "repair-bde.exe")
| where tolower(FileName) == "bootmenuux.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(InitiatingProcessFileName) endswith "bootim.exe")
| where tolower(FileName) == "bootux.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(InitiatingProcessFileName) endswith "bootim.exe")
| where tolower(FileName) == "cabinet.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "bootim.exe" and tolower(InitiatingProcessFileName) endswith "certutil.exe" and tolower(InitiatingProcessFileName) endswith "cmdl32.exe" and tolower(InitiatingProcessFileName) endswith "expand.exe" and tolower(InitiatingProcessFileName) endswith "extrac32.exe" and tolower(InitiatingProcessFileName) endswith "iesettingsync.exe" and tolower(InitiatingProcessFileName) endswith "licensingdiag.exe" and tolower(InitiatingProcessFileName) endswith "makecab.exe" and tolower(InitiatingProcessFileName) endswith "msdt.exe" and tolower(InitiatingProcessFileName) endswith "musnotification.exe" and tolower(InitiatingProcessFileName) endswith "musnotificationux.exe" and tolower(InitiatingProcessFileName) endswith "netsh.exe" and tolower(InitiatingProcessFileName) endswith "plasrv.exe" and tolower(InitiatingProcessFileName) endswith "pnputil.exe" and tolower(InitiatingProcessFileName) endswith "reagentc.exe" and tolower(InitiatingProcessFileName) endswith "recdisc.exe" and tolower(InitiatingProcessFileName) endswith "relpost.exe" and tolower(InitiatingProcessFileName) endswith "resetengine.exe" and tolower(InitiatingProcessFileName) endswith "sdclt.exe" and tolower(InitiatingProcessFileName) endswith "sihclient.exe" and tolower(InitiatingProcessFileName) endswith "systemreset.exe" and tolower(InitiatingProcessFileName) endswith "usocoreworker.exe" and tolower(InitiatingProcessFileName) endswith "wextract.exe" and tolower(InitiatingProcessFileName) endswith "wimserv.exe" and tolower(InitiatingProcessFileName) endswith "wpnpinst.exe")
| where tolower(FileName) == "cabview.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "certcli.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "certreq.exe" and tolower(InitiatingProcessFileName) endswith "certutil.exe" and tolower(InitiatingProcessFileName) endswith "repadmin.exe")
| where tolower(FileName) == "certenroll.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "certenrollctrl.exe" and tolower(InitiatingProcessFileName) endswith "dmcertinst.exe")
| where tolower(FileName) == "cfgmgr32.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "write.exe")
| where tolower(FileName) == "cldapi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "compmgmtlauncher.exe" and tolower(InitiatingProcessFileName) endswith "dpiscaling.exe" and tolower(InitiatingProcessFileName) endswith "psr.exe" and tolower(InitiatingProcessFileName) endswith "resmon.exe" and tolower(InitiatingProcessFileName) endswith "sdclt.exe" and tolower(InitiatingProcessFileName) endswith "slui.exe" and tolower(InitiatingProcessFileName) endswith "workfolders.exe" and tolower(InitiatingProcessFileName) endswith "write.exe")
| where tolower(FileName) == "clipc.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "licensingdiag.exe")
| where tolower(FileName) == "clusapi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "dfsrdiag.exe" and tolower(InitiatingProcessFileName) endswith "msdtc.exe" and tolower(InitiatingProcessFileName) endswith "tieringengineservice.exe" and tolower(InitiatingProcessFileName) endswith "wbengine.exe")
| where tolower(FileName) == "cmpbk32.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "cmdl32.exe")
| where tolower(FileName) == "cmutil.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "cmstp.exe")
| where tolower(FileName) == "coloradapterclient.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "colorcpl.exe" and tolower(InitiatingProcessFileName) endswith "dccw.exe")
| where tolower(FileName) == "colorui.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "colorcpl.exe")
| where tolower(FileName) == "comdlg32.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "configmanager2.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(InitiatingProcessFileName) endswith "hvsievaluator.exe")
| where tolower(FileName) == "connect.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "coredplus.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(InitiatingProcessFileName) endswith "omadmclient.exe")
| where tolower(FileName) == "coremessaging.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "dwm.exe" and tolower(InitiatingProcessFileName) endswith "sihost.exe")
| where tolower(FileName) == "coreuicomponents.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "dwm.exe")
| where tolower(FileName) == "credui.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "efsui.exe" and tolower(InitiatingProcessFileName) endswith "fxssvc.exe" and tolower(InitiatingProcessFileName) endswith "gpfixup.exe" and tolower(InitiatingProcessFileName) endswith "licmgr.exe" and tolower(InitiatingProcessFileName) endswith "mstsc.exe" and tolower(InitiatingProcessFileName) endswith "netdom.exe" and tolower(InitiatingProcessFileName) endswith "nlbmgr.exe" and tolower(InitiatingProcessFileName) endswith "perfmon.exe" and tolower(InitiatingProcessFileName) endswith "rekeywiz.exe" and tolower(InitiatingProcessFileName) endswith "rpcping.exe" and tolower(InitiatingProcessFileName) endswith "runas.exe" and tolower(InitiatingProcessFileName) endswith "systempropertiesadvanced.exe" and tolower(InitiatingProcessFileName) endswith "taskmgr.exe" and tolower(InitiatingProcessFileName) endswith "wbadmin.exe" and tolower(InitiatingProcessFileName) endswith "wfs.exe" and tolower(InitiatingProcessFileName) endswith "wkspbroker.exe")
| where tolower(FileName) == "cryptbase.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "alg.exe" and tolower(InitiatingProcessFileName) endswith "calc.exe" and tolower(InitiatingProcessFileName) endswith "compmgmtlauncher.exe" and tolower(InitiatingProcessFileName) endswith "computerdefaults.exe" and tolower(InitiatingProcessFileName) endswith "disksnapshot.exe" and tolower(InitiatingProcessFileName) endswith "dpiscaling.exe" and tolower(InitiatingProcessFileName) endswith "efsui.exe" and tolower(InitiatingProcessFileName) endswith "filehistory.exe" and tolower(InitiatingProcessFileName) endswith "fodhelper.exe" and tolower(InitiatingProcessFileName) endswith "ie4uinit.exe" and tolower(InitiatingProcessFileName) endswith "lpksetup.exe" and tolower(InitiatingProcessFileName) endswith "mfpmp.exe" and tolower(InitiatingProcessFileName) endswith "mshta.exe" and tolower(InitiatingProcessFileName) endswith "mstsc.exe" and tolower(InitiatingProcessFileName) endswith "net1.exe" and tolower(InitiatingProcessFileName) endswith "netplwiz.exe" and tolower(InitiatingProcessFileName) endswith "netsh.exe" and tolower(InitiatingProcessFileName) endswith "presentationhost.exe" and tolower(InitiatingProcessFileName) endswith "quickassist.exe" and tolower(InitiatingProcessFileName) endswith "rdpclip.exe" and tolower(InitiatingProcessFileName) endswith "rekeywiz.exe" and tolower(InitiatingProcessFileName) endswith "resmon.exe" and tolower(InitiatingProcessFileName) endswith "rmactivate.exe" and tolower(InitiatingProcessFileName) endswith "rmactivate_ssp_isv.exe" and tolower(InitiatingProcessFileName) endswith "sdclt.exe" and tolower(InitiatingProcessFileName) endswith "slui.exe" and tolower(InitiatingProcessFileName) endswith "sppextcomobj.exe" and tolower(InitiatingProcessFileName) endswith "stordiag.exe" and tolower(InitiatingProcessFileName) endswith "tzsync.exe" and tolower(InitiatingProcessFileName) endswith "uevappmonitor.exe" and tolower(InitiatingProcessFileName) endswith "useraccountcontrolsettings.exe" and tolower(InitiatingProcessFileName) endswith "workfolders.exe" and tolower(InitiatingProcessFileName) endswith "write.exe" and tolower(InitiatingProcessFileName) endswith "wscadminui.exe" and tolower(InitiatingProcessFileName) endswith "minecraftlauncher.exe")
| where tolower(FileName) == "cryptdll.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "at.exe" and tolower(InitiatingProcessFileName) endswith "netdom.exe")
| where tolower(FileName) == "cryptsp.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "bcdedit.exe" and tolower(InitiatingProcessFileName) endswith "disksnapshot.exe" and tolower(InitiatingProcessFileName) endswith "genvalobj.exe" and tolower(InitiatingProcessFileName) endswith "omadmclient.exe" and tolower(InitiatingProcessFileName) endswith "rmactivate.exe" and tolower(InitiatingProcessFileName) endswith "rmactivate_isv.exe" and tolower(InitiatingProcessFileName) endswith "rmactivate_ssp.exe" and tolower(InitiatingProcessFileName) endswith "rmactivate_ssp_isv.exe" and tolower(InitiatingProcessFileName) endswith "werfault.exe")
| where tolower(FileName) == "cryptui.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "certutil.exe" and tolower(InitiatingProcessFileName) endswith "efsui.exe" and tolower(InitiatingProcessFileName) endswith "mstsc.exe" and tolower(InitiatingProcessFileName) endswith "rekeywiz.exe")
| where tolower(FileName) == "cryptxml.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "clipup.exe" and tolower(InitiatingProcessFileName) endswith "sppsvc.exe")
| where tolower(FileName) == "cscapi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "certreq.exe" and tolower(InitiatingProcessFileName) endswith "microsoft.uev.cscunpintool.exe")
| where tolower(FileName) == "cscobj.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "cscui.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "d2d1.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "dataexchangehost.exe" and tolower(InitiatingProcessFileName) endswith "dwm.exe" and tolower(InitiatingProcessFileName) endswith "eoaexperiences.exe" and tolower(InitiatingProcessFileName) endswith "gamepanel.exe" and tolower(InitiatingProcessFileName) endswith "quickassist.exe" and tolower(InitiatingProcessFileName) endswith "vsgraphicsdesktopengine.exe" and tolower(InitiatingProcessFileName) endswith "vsgraphicsremoteengine.exe")
| where tolower(FileName) == "d3d10.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "winsat.exe")
| where tolower(FileName) == "d3d10_1.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "winsat.exe")
| where tolower(FileName) == "d3d10_1core.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "winsat.exe")
| where tolower(FileName) == "d3d10core.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "winsat.exe")
| where tolower(FileName) == "d3d10warp.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "slidetoshutdown.exe" and tolower(InitiatingProcessFileName) endswith "systemreset.exe")
| where tolower(FileName) == "d3d11.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "dataexchangehost.exe" and tolower(InitiatingProcessFileName) endswith "dwm.exe" and tolower(InitiatingProcessFileName) endswith "dxcap.exe" and tolower(InitiatingProcessFileName) endswith "dxgiadaptercache.exe" and tolower(InitiatingProcessFileName) endswith "gamepanel.exe" and tolower(InitiatingProcessFileName) endswith "mdeserver.exe" and tolower(InitiatingProcessFileName) endswith "quickassist.exe" and tolower(InitiatingProcessFileName) endswith "systemreset.exe" and tolower(InitiatingProcessFileName) endswith "taskmgr.exe" and tolower(InitiatingProcessFileName) endswith "vsgraphicsdesktopengine.exe" and tolower(InitiatingProcessFileName) endswith "vsgraphicsremoteengine.exe" and tolower(InitiatingProcessFileName) endswith "winsat.exe")
| where tolower(FileName) == "d3d12.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "dxgiadaptercache.exe" and tolower(InitiatingProcessFileName) endswith "taskmgr.exe")
| where tolower(FileName) == "d3d9.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "magnify.exe")
| where tolower(FileName) == "d3dcompiler_47.dll" and (tolower(FolderPath) !contains "c:\program files\windows kits\10\bin\\x64" and tolower(FolderPath) !contains "c:\program files\windows kits\10\bin\\x86" and tolower(FolderPath) !contains "c:\program files\windows kits\10\redist\d3d\x64" and tolower(FolderPath) !contains "c:\program files\windows kits\10\redist\d3d\x86" and tolower(FolderPath) !contains "c:\program files\wireshark" and tolower(FolderPath) !contains "c:\program files\cisco systems\cisco jabber" and tolower(FolderPath) !contains "c:\program files\microsoft\edge\application\" and tolower(FolderPath) !contains "c:\program files\google\chrome\application\" and tolower(FolderPath) !contains "appdata\local\microsoft\teams\stage" and tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "dwm.exe")
| where tolower(FileName) == "d3dx9_43.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "d3dim9.exe")
| where tolower(FileName) == "dataexchange.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "davclnt.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "dbgcore.dll" and (tolower(FolderPath) !contains "c:\program files\windows kits\10\debuggers\arm" and tolower(FolderPath) !contains "c:\program files\windows kits\10\debuggers\arm\srcsrv" and tolower(FolderPath) !contains "c:\program files\windows kits\10\debuggers\arm64" and tolower(FolderPath) !contains "c:\program files\windows kits\10\debuggers\arm64\srcsrv" and tolower(FolderPath) !contains "c:\program files\windows kits\10\debuggers\x64" and tolower(FolderPath) !contains "c:\program files\windows kits\10\debuggers\x64\srcsrv" and tolower(FolderPath) !contains "c:\program files\windows kits\10\debuggers\x86" and tolower(FolderPath) !contains "c:\program files\windows kits\10\debuggers\x86\srcsrv" and tolower(FolderPath) !contains "c:\program files\microsoft office\root\office" and tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "deploymentcsphelper.exe" and tolower(InitiatingProcessFileName) endswith "djoin.exe" and tolower(InitiatingProcessFileName) endswith "dnscacheugc.exe" and tolower(InitiatingProcessFileName) endswith "ieunatt.exe" and tolower(InitiatingProcessFileName) endswith "muiunattend.exe" and tolower(InitiatingProcessFileName) endswith "netbtugc.exe" and tolower(InitiatingProcessFileName) endswith "netiougc.exe" and tolower(InitiatingProcessFileName) endswith "pnpunattend.exe" and tolower(InitiatingProcessFileName) endswith "setupugc.exe" and tolower(InitiatingProcessFileName) endswith "systemreset.exe" and tolower(InitiatingProcessFileName) endswith "werfault.exe" and tolower(InitiatingProcessFileName) endswith "werfaultsecure.exe")
| where tolower(FileName) == "dbghelp.dll" and (tolower(FolderPath) !contains "c:\program files\windows kits\10\debuggers\arm" and tolower(FolderPath) !contains "c:\program files\windows kits\10\debuggers\arm\srcsrv" and tolower(FolderPath) !contains "c:\program files\windows kits\10\debuggers\arm64" and tolower(FolderPath) !contains "c:\program files\windows kits\10\debuggers\arm64\srcsrv" and tolower(FolderPath) !contains "c:\program files\windows kits\10\debuggers\x64" and tolower(FolderPath) !contains "c:\program files\windows kits\10\debuggers\x64\srcsrv" and tolower(FolderPath) !contains "c:\program files\windows kits\10\debuggers\x86" and tolower(FolderPath) !contains "c:\program files\windows kits\10\debuggers\x86\srcsrv" and tolower(FolderPath) !contains "c:\program files\cisco systems\cisco jabber" and tolower(FolderPath) !contains "c:\program files\microsoft office\root\office" and tolower(FolderPath) !contains "c:\program files\microsoft office\root\vfs\programfilesx86\microsoft analysis services\as oledb\140" and tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "bootim.exe" and tolower(InitiatingProcessFileName) endswith "dxcap.exe" and tolower(InitiatingProcessFileName) endswith "taskkill.exe" and tolower(InitiatingProcessFileName) endswith "tasklist.exe" and tolower(InitiatingProcessFileName) endswith "tracerpt.exe" and tolower(InitiatingProcessFileName) endswith "werfault.exe")
| where tolower(FileName) == "dbgmodel.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(FolderPath) !contains "c:\program files\windows kits\10\debuggers\" and tolower(InitiatingProcessFileName) endswith "ntsd.exe")
| where tolower(FileName) == "dcntel.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(InitiatingProcessFileName) endswith "devicecensus.exe")
| where tolower(FileName) == "dcomp.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "dataexchangehost.exe" and tolower(InitiatingProcessFileName) endswith "gamepanel.exe" and tolower(InitiatingProcessFileName) endswith "quickassist.exe")
| where tolower(FileName) == "defragproxy.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "desktopshellext.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "deviceassociation.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "eduprintprov.exe" and tolower(InitiatingProcessFileName) endswith "proximityuxhost.exe")
| where tolower(FileName) == "devicecredential.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "devicecredentialdeployment.exe")
| where tolower(FileName) == "devicepairing.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "devobj.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "bthudtask.exe" and tolower(InitiatingProcessFileName) endswith "chkdsk.exe" and tolower(InitiatingProcessFileName) endswith "chkntfs.exe" and tolower(InitiatingProcessFileName) endswith "deviceenroller.exe" and tolower(InitiatingProcessFileName) endswith "dispdiag.exe" and tolower(InitiatingProcessFileName) endswith "dmomacpmo.exe" and tolower(InitiatingProcessFileName) endswith "drvinst.exe" and tolower(InitiatingProcessFileName) endswith "fsavailux.exe" and tolower(InitiatingProcessFileName) endswith "fsquirt.exe" and tolower(InitiatingProcessFileName) endswith "immersivetpmvscmgrsvr.exe" and tolower(InitiatingProcessFileName) endswith "iscsicli.exe" and tolower(InitiatingProcessFileName) endswith "label.exe" and tolower(InitiatingProcessFileName) endswith "mdmappinstaller.exe" and tolower(InitiatingProcessFileName) endswith "mdmdiagnosticstool.exe" and tolower(InitiatingProcessFileName) endswith "omadmclient.exe" and tolower(InitiatingProcessFileName) endswith "osk.exe" and tolower(InitiatingProcessFileName) endswith "pnputil.exe" and tolower(InitiatingProcessFileName) endswith "rdpclip.exe" and tolower(InitiatingProcessFileName) endswith "recover.exe" and tolower(InitiatingProcessFileName) endswith "rmttpmvscmgrsvr.exe" and tolower(InitiatingProcessFileName) endswith "tabcal.exe" and tolower(InitiatingProcessFileName) endswith "vsgraphicsdesktopengine.exe" and tolower(InitiatingProcessFileName) endswith "vssvc.exe" and tolower(InitiatingProcessFileName) endswith "workfolders.exe")
| where tolower(FileName) == "devrtl.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "drvinst.exe" and tolower(InitiatingProcessFileName) endswith "pnpunattend.exe" and tolower(InitiatingProcessFileName) endswith "systemsettingsadminflows.exe" and tolower(InitiatingProcessFileName) endswith "wowreg32.exe")
| where tolower(FileName) == "dhcpcmonitor.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "netsh.exe")
| where tolower(FileName) == "dhcpcsvc.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "ipconfig.exe" and tolower(InitiatingProcessFileName) endswith "netiougc.exe" and tolower(InitiatingProcessFileName) endswith "netsh.exe")
| where tolower(FileName) == "dhcpcsvc6.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "ipconfig.exe" and tolower(InitiatingProcessFileName) endswith "netsh.exe")
| where tolower(FileName) == "directmanipulation.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "dismapi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "bootim.exe" and tolower(InitiatingProcessFileName) endswith "deploymentcsphelper.exe" and tolower(InitiatingProcessFileName) endswith "directxdatabaseupdater.exe" and tolower(InitiatingProcessFileName) endswith "hvsievaluator.exe" and tolower(InitiatingProcessFileName) endswith "resetengine.exe" and tolower(InitiatingProcessFileName) endswith "systemreset.exe" and tolower(InitiatingProcessFileName) endswith "systemsettingsadminflows.exe")
| where tolower(FileName) == "dismcore.dll" and (tolower(FolderPath) !contains "c:\windows\system32\dism" and tolower(FolderPath) !contains "c:\windows\syswow64\dism")
| where tolower(FileName) == "dmcfgutils.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "omadmclient.exe")
| where tolower(FileName) == "dmcmnutils.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "deviceenroller.exe" and tolower(InitiatingProcessFileName) endswith "dmcertinst.exe" and tolower(InitiatingProcessFileName) endswith "dmcfghost.exe" and tolower(InitiatingProcessFileName) endswith "dmnotificationbroker.exe" and tolower(InitiatingProcessFileName) endswith "dmomacpmo.exe" and tolower(InitiatingProcessFileName) endswith "edpcleanup.exe" and tolower(InitiatingProcessFileName) endswith "hvsievaluator.exe" and tolower(InitiatingProcessFileName) endswith "mdmappinstaller.exe" and tolower(InitiatingProcessFileName) endswith "mdmdiagnosticstool.exe" and tolower(InitiatingProcessFileName) endswith "mousocoreworker.exe" and tolower(InitiatingProcessFileName) endswith "musnotificationux.exe" and tolower(InitiatingProcessFileName) endswith "musnotifyicon.exe" and tolower(InitiatingProcessFileName) endswith "omadmclient.exe" and tolower(InitiatingProcessFileName) endswith "upgraderesultsui.exe" and tolower(InitiatingProcessFileName) endswith "usocoreworker.exe")
| where tolower(FileName) == "dmcommandlineutils.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "provtool.exe")
| where tolower(FileName) == "dmenrollengine.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "deviceenroller.exe" and tolower(InitiatingProcessFileName) endswith "dmomacpmo.exe" and tolower(InitiatingProcessFileName) endswith "mdmagent.exe" and tolower(InitiatingProcessFileName) endswith "mdmappinstaller.exe" and tolower(InitiatingProcessFileName) endswith "mdmdiagnosticstool.exe" and tolower(InitiatingProcessFileName) endswith "omadmclient.exe" and tolower(InitiatingProcessFileName) endswith "workfolders.exe")
| where tolower(FileName) == "dmenterprisediagnostics.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(InitiatingProcessFileName) endswith "deviceenroller.exe" and tolower(InitiatingProcessFileName) endswith "omadmclient.exe")
| where tolower(FileName) == "dmiso8601utils.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "mdmdiagnosticstool.exe" and tolower(InitiatingProcessFileName) endswith "mousocoreworker.exe" and tolower(InitiatingProcessFileName) endswith "omadmclient.exe" and tolower(InitiatingProcessFileName) endswith "usocoreworker.exe")
| where tolower(FileName) == "dmoleaututils.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "omadmclient.exe" and tolower(InitiatingProcessFileName) endswith "usocoreworker.exe")
| where tolower(FileName) == "dmprocessxmlfiltered.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "dmomacpmo.exe")
| where tolower(FileName) == "dmpushproxy.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "dmcfghost.exe" and tolower(InitiatingProcessFileName) endswith "omadmrpc.exe")
| where tolower(FileName) == "dmxmlhelputils.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "dmcfghost.exe" and tolower(InitiatingProcessFileName) endswith "omadmclient.exe")
| where tolower(FileName) == "dnsapi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "checknetisolation.exe" and tolower(InitiatingProcessFileName) endswith "dcdiag.exe" and tolower(InitiatingProcessFileName) endswith "dnscmd.exe" and tolower(InitiatingProcessFileName) endswith "edpcleanup.exe" and tolower(InitiatingProcessFileName) endswith "ipconfig.exe" and tolower(InitiatingProcessFileName) endswith "lpremove.exe" and tolower(InitiatingProcessFileName) endswith "msdtc.exe" and tolower(InitiatingProcessFileName) endswith "netdom.exe" and tolower(InitiatingProcessFileName) endswith "netsh.exe" and tolower(InitiatingProcessFileName) endswith "nslookup.exe" and tolower(InitiatingProcessFileName) endswith "rendom.exe" and tolower(InitiatingProcessFileName) endswith "repadmin.exe" and tolower(InitiatingProcessFileName) endswith "securityhealthservice.exe" and tolower(InitiatingProcessFileName) endswith "setupugc.exe" and tolower(InitiatingProcessFileName) endswith "sihclient.exe" and tolower(InitiatingProcessFileName) endswith "spoolsv.exe" and tolower(InitiatingProcessFileName) endswith "sppextcomobj.exe" and tolower(InitiatingProcessFileName) endswith "systempropertiesadvanced.exe" and tolower(InitiatingProcessFileName) endswith "systemsettingsadminflows.exe" and tolower(InitiatingProcessFileName) endswith "tieringengineservice.exe" and tolower(InitiatingProcessFileName) endswith "wbengine.exe" and tolower(InitiatingProcessFileName) endswith "wkspbroker.exe")
| where tolower(FileName) == "dot3api.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "netsh.exe")
| where tolower(FileName) == "dot3cfg.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "netsh.exe")
| where tolower(FileName) == "dpx.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "lpksetup.exe" and tolower(InitiatingProcessFileName) endswith "wusa.exe")
| where tolower(FileName) == "drprov.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "drvstore.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "infdefaultinstall.exe" and tolower(InitiatingProcessFileName) endswith "securityhealthservice.exe")
| where tolower(FileName) == "dsclient.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "dmcfghost.exe" and tolower(InitiatingProcessFileName) endswith "dmomacpmo.exe" and tolower(InitiatingProcessFileName) endswith "dstokenclean.exe")
| where tolower(FileName) == "dsparse.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "dcdiag.exe" and tolower(InitiatingProcessFileName) endswith "dfsrdiag.exe" and tolower(InitiatingProcessFileName) endswith "dmcertinst.exe" and tolower(InitiatingProcessFileName) endswith "netdom.exe" and tolower(InitiatingProcessFileName) endswith "rendom.exe")
| where tolower(FileName) == "dsprop.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "dsquery.exe")
| where tolower(FileName) == "dsreg.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "bitlockerdeviceencryption.exe" and tolower(InitiatingProcessFileName) endswith "dsregcmd.exe")
| where tolower(FileName) == "dsrole.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "certutil.exe" and tolower(InitiatingProcessFileName) endswith "cipher.exe" and tolower(InitiatingProcessFileName) endswith "csvde.exe" and tolower(InitiatingProcessFileName) endswith "dcdiag.exe" and tolower(InitiatingProcessFileName) endswith "dsdbutil.exe" and tolower(InitiatingProcessFileName) endswith "efsui.exe" and tolower(InitiatingProcessFileName) endswith "gpfixup.exe" and tolower(InitiatingProcessFileName) endswith "net1.exe" and tolower(InitiatingProcessFileName) endswith "netdom.exe" and tolower(InitiatingProcessFileName) endswith "netplwiz.exe" and tolower(InitiatingProcessFileName) endswith "ntdsutil.exe" and tolower(InitiatingProcessFileName) endswith "rekeywiz.exe" and tolower(InitiatingProcessFileName) endswith "repadmin.exe" and tolower(InitiatingProcessFileName) endswith "systempropertiesadvanced.exe" and tolower(InitiatingProcessFileName) endswith "winrs.exe" and tolower(InitiatingProcessFileName) endswith "wsmanhttpconfig.exe" and tolower(InitiatingProcessFileName) endswith "wsmprovhost.exe")
| where tolower(FileName) == "dui70.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "bdeunlock.exe" and tolower(InitiatingProcessFileName) endswith "camerasettings.exe" and tolower(InitiatingProcessFileName) endswith "certreq.exe" and tolower(InitiatingProcessFileName) endswith "dmnotificationbroker.exe" and tolower(InitiatingProcessFileName) endswith "dpapimig.exe" and tolower(InitiatingProcessFileName) endswith "licensingui.exe" and tolower(InitiatingProcessFileName) endswith "optionalfeatures.exe" and tolower(InitiatingProcessFileName) endswith "osk.exe" and tolower(InitiatingProcessFileName) endswith "passwordonwakesettingflyout.exe" and tolower(InitiatingProcessFileName) endswith "phoneactivate.exe" and tolower(InitiatingProcessFileName) endswith "proximityuxhost.exe" and tolower(InitiatingProcessFileName) endswith "sessionmsg.exe" and tolower(InitiatingProcessFileName) endswith "sethc.exe" and tolower(InitiatingProcessFileName) endswith "sysreseterr.exe" and tolower(InitiatingProcessFileName) endswith "systemsettingsadminflows.exe" and tolower(InitiatingProcessFileName) endswith "systemsettingsremovedevice.exe" and tolower(InitiatingProcessFileName) endswith "utilman.exe" and tolower(InitiatingProcessFileName) endswith "windowsactiondialog.exe" and tolower(InitiatingProcessFileName) endswith "wlrmdr.exe")
| where tolower(FileName) == "duser.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "bdeunlock.exe" and tolower(InitiatingProcessFileName) endswith "displayswitch.exe" and tolower(InitiatingProcessFileName) endswith "easeofaccessdialog.exe" and tolower(InitiatingProcessFileName) endswith "lockscreencontentserver.exe" and tolower(InitiatingProcessFileName) endswith "mmc.exe" and tolower(InitiatingProcessFileName) endswith "msdt.exe" and tolower(InitiatingProcessFileName) endswith "osk.exe" and tolower(InitiatingProcessFileName) endswith "rekeywiz.exe" and tolower(InitiatingProcessFileName) endswith "sessionmsg.exe" and tolower(InitiatingProcessFileName) endswith "taskmgr.exe" and tolower(InitiatingProcessFileName) endswith "utilman.exe")
| where tolower(FileName) == "dusmapi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "datausagelivetiletask.exe")
| where tolower(FileName) == "dwmapi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "certreq.exe" and tolower(InitiatingProcessFileName) endswith "devicepairingwizard.exe" and tolower(InitiatingProcessFileName) endswith "displayswitch.exe" and tolower(InitiatingProcessFileName) endswith "dxpserver.exe" and tolower(InitiatingProcessFileName) endswith "fsquirt.exe" and tolower(InitiatingProcessFileName) endswith "gamepanel.exe" and tolower(InitiatingProcessFileName) endswith "lockscreencontentserver.exe" and tolower(InitiatingProcessFileName) endswith "mblctr.exe" and tolower(InitiatingProcessFileName) endswith "osk.exe" and tolower(InitiatingProcessFileName) endswith "proximityuxhost.exe" and tolower(InitiatingProcessFileName) endswith "rdpclip.exe" and tolower(InitiatingProcessFileName) endswith "rdpshell.exe" and tolower(InitiatingProcessFileName) endswith "rdvghelper.exe" and tolower(InitiatingProcessFileName) endswith "sndvol.exe" and tolower(InitiatingProcessFileName) endswith "snippingtool.exe" and tolower(InitiatingProcessFileName) endswith "wmpdmc.exe")
| where tolower(FileName) == "dwmcore.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(InitiatingProcessFileName) endswith "dwm.exe")
| where tolower(FileName) == "dwrite.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "cttune.exe" and tolower(InitiatingProcessFileName) endswith "dataexchangehost.exe" and tolower(InitiatingProcessFileName) endswith "gamepanel.exe")
| where tolower(FileName) == "dxcore.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "taskmgr.exe")
| where tolower(FileName) == "dxgi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "applicationframehost.exe" and tolower(InitiatingProcessFileName) endswith "dataexchangehost.exe" and tolower(InitiatingProcessFileName) endswith "dwm.exe" and tolower(InitiatingProcessFileName) endswith "dxgiadaptercache.exe" and tolower(InitiatingProcessFileName) endswith "gamepanel.exe" and tolower(InitiatingProcessFileName) endswith "mdeserver.exe" and tolower(InitiatingProcessFileName) endswith "quickassist.exe" and tolower(InitiatingProcessFileName) endswith "systemreset.exe" and tolower(InitiatingProcessFileName) endswith "taskmgr.exe" and tolower(InitiatingProcessFileName) endswith "vsgraphicsremoteengine.exe" and tolower(InitiatingProcessFileName) endswith "winsat.exe")
| where tolower(FileName) == "dxva2.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "dccw.exe" and tolower(InitiatingProcessFileName) endswith "dispdiag.exe")
| where tolower(FileName) == "dynamoapi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(InitiatingProcessFileName) endswith "mdmdiagnosticstool.exe")
| where tolower(FileName) == "eappcfg.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "netsh.exe")
| where tolower(FileName) == "eappprxy.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "netsh.exe")
| where tolower(FileName) == "edgeiso.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "microsoftedgebchost.exe" and tolower(InitiatingProcessFileName) endswith "microsoftedgecp.exe" and tolower(InitiatingProcessFileName) endswith "microsoftedgedevtools.exe" and tolower(InitiatingProcessFileName) endswith "microsoftedgesh.exe")
| where tolower(FileName) == "edputil.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "calc.exe" and tolower(InitiatingProcessFileName) endswith "compmgmtlauncher.exe" and tolower(InitiatingProcessFileName) endswith "computerdefaults.exe" and tolower(InitiatingProcessFileName) endswith "dpiscaling.exe" and tolower(InitiatingProcessFileName) endswith "fodhelper.exe" and tolower(InitiatingProcessFileName) endswith "mobsync.exe" and tolower(InitiatingProcessFileName) endswith "resmon.exe" and tolower(InitiatingProcessFileName) endswith "sdclt.exe" and tolower(InitiatingProcessFileName) endswith "slui.exe" and tolower(InitiatingProcessFileName) endswith "workfolders.exe" and tolower(InitiatingProcessFileName) endswith "write.exe")
| where tolower(FileName) == "efsadu.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "efsui.exe" and tolower(InitiatingProcessFileName) endswith "rekeywiz.exe")
| where tolower(FileName) == "efsutil.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "cipher.exe" and tolower(InitiatingProcessFileName) endswith "efsui.exe" and tolower(InitiatingProcessFileName) endswith "rekeywiz.exe")
| where tolower(FileName) == "esent.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "dfsrdiag.exe" and tolower(InitiatingProcessFileName) endswith "dsdbutil.exe" and tolower(InitiatingProcessFileName) endswith "esentutl.exe" and tolower(InitiatingProcessFileName) endswith "tieringengineservice.exe" and tolower(InitiatingProcessFileName) endswith "ntdsutil.exe")
| where tolower(FileName) == "execmodelproxy.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "explorerframe.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "fastprox.dll" and (tolower(FolderPath) !contains "c:\windows\system32\wbem" and tolower(FolderPath) !contains "c:\windows\syswow64\wbem")
| where tolower(FileName) == "faultrep.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "werfault.exe" and tolower(InitiatingProcessFileName) endswith "werfaultsecure.exe")
| where tolower(FileName) == "fddevquery.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "feclient.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "cipher.exe" and tolower(InitiatingProcessFileName) endswith "efsui.exe" and tolower(InitiatingProcessFileName) endswith "rekeywiz.exe")
| where tolower(FileName) == "fhcfg.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "fhsvcctl.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(InitiatingProcessFileName) endswith "fhmanagew.exe")
| where tolower(FileName) == "firewallapi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "checknetisolation.exe" and tolower(InitiatingProcessFileName) endswith "edpcleanup.exe" and tolower(InitiatingProcessFileName) endswith "lpremove.exe" and tolower(InitiatingProcessFileName) endswith "netsh.exe" and tolower(InitiatingProcessFileName) endswith "securityhealthservice.exe" and tolower(InitiatingProcessFileName) endswith "systemsettingsadminflows.exe")
| where tolower(FileName) == "flightsettings.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "fltlib.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "agentservice.exe" and tolower(InitiatingProcessFileName) endswith "bootim.exe" and tolower(InitiatingProcessFileName) endswith "compmgmtlauncher.exe" and tolower(InitiatingProcessFileName) endswith "dpiscaling.exe" and tolower(InitiatingProcessFileName) endswith "dfsrdiag.exe" and tolower(InitiatingProcessFileName) endswith "fltmc.exe" and tolower(InitiatingProcessFileName) endswith "psr.exe" and tolower(InitiatingProcessFileName) endswith "resmon.exe" and tolower(InitiatingProcessFileName) endswith "sdclt.exe" and tolower(InitiatingProcessFileName) endswith "slui.exe" and tolower(InitiatingProcessFileName) endswith "vssvc.exe" and tolower(InitiatingProcessFileName) endswith "wbengine.exe" and tolower(InitiatingProcessFileName) endswith "workfolders.exe" and tolower(InitiatingProcessFileName) endswith "write.exe")
| where tolower(FileName) == "framedynos.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "dfsrdiag.exe" and tolower(InitiatingProcessFileName) endswith "driverquery.exe" and tolower(InitiatingProcessFileName) endswith "getmac.exe" and tolower(InitiatingProcessFileName) endswith "openfiles.exe" and tolower(InitiatingProcessFileName) endswith "taskkill.exe")
| where tolower(FileName) == "fveapi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "baaupdate.exe" and tolower(InitiatingProcessFileName) endswith "bdechangepin.exe" and tolower(InitiatingProcessFileName) endswith "fvenotify.exe" and tolower(InitiatingProcessFileName) endswith "fveprompt.exe" and tolower(InitiatingProcessFileName) endswith "resetengine.exe" and tolower(InitiatingProcessFileName) endswith "systemreset.exe")
| where tolower(FileName) == "fveskybackup.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(InitiatingProcessFileName) endswith "bitlockerdeviceencryption.exe")
| where tolower(FileName) == "fvewiz.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(InitiatingProcessFileName) endswith "bitlockerwizard.exe" and tolower(InitiatingProcessFileName) endswith "bitlockerwizardelev.exe")
| where tolower(FileName) == "fwbase.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "checknetisolation.exe" and tolower(InitiatingProcessFileName) endswith "edpcleanup.exe" and tolower(InitiatingProcessFileName) endswith "lpremove.exe" and tolower(InitiatingProcessFileName) endswith "netsh.exe" and tolower(InitiatingProcessFileName) endswith "securityhealthservice.exe" and tolower(InitiatingProcessFileName) endswith "systemsettingsadminflows.exe")
| where tolower(FileName) == "fwcfg.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "netsh.exe")
| where tolower(FileName) == "fwpolicyiomgr.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "netsh.exe")
| where tolower(FileName) == "fwpuclnt.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "checknetisolation.exe" and tolower(InitiatingProcessFileName) endswith "netsh.exe")
| where tolower(FileName) == "fxsapi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\system32\driverstore\filerepository\prnms002.inf_\amd64" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "fxsunatd.exe")
| where tolower(FileName) == "fxsst.dll" and (tolower(FolderPath) !contains "c:\windows\system32")
| where tolower(FileName) == "fxstiff.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\system32\driverstore\filerepository\prnms002.inf_\amd64" and tolower(InitiatingProcessFileName) endswith "fxssvc.exe")
| where tolower(FileName) == "getuname.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "charmap.exe")
| where tolower(FileName) == "gpapi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "gpapi.exe")
| where tolower(FileName) == "hid.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "psr.exe" and tolower(InitiatingProcessFileName) endswith "tabcal.exe")
| where tolower(FileName) == "hnetmon.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "netsh.exe")
| where tolower(FileName) == "httpapi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "netsh.exe" and tolower(InitiatingProcessFileName) endswith "wifitask.exe" and tolower(InitiatingProcessFileName) endswith "wsmanhttpconfig.exe")
| where tolower(FileName) == "icmp.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "nlbmgr.exe")
| where tolower(FileName) == "idstore.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "ieadvpack.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "ie4uinit.exe")
| where tolower(FileName) == "iedkcs32.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "ie4uinit.exe")
| where tolower(FileName) == "iernonce.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "runonce.exe")
| where tolower(FileName) == "iertutil.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "browserexport.exe" and tolower(InitiatingProcessFileName) endswith "cipher.exe" and tolower(InitiatingProcessFileName) endswith "iesettingsync.exe" and tolower(InitiatingProcessFileName) endswith "launchwinapp.exe" and tolower(InitiatingProcessFileName) endswith "microsoftedgebchost.exe" and tolower(InitiatingProcessFileName) endswith "microsoftedgecp.exe" and tolower(InitiatingProcessFileName) endswith "microsoftedgedevtools.exe" and tolower(InitiatingProcessFileName) endswith "microsoftedgesh.exe" and tolower(InitiatingProcessFileName) endswith "wwahost.exe")
| where tolower(FileName) == "ifmon.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "netsh.exe")
| where tolower(FileName) == "ifsutil.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "convert.exe" and tolower(InitiatingProcessFileName) endswith "fsavailux.exe" and tolower(InitiatingProcessFileName) endswith "label.exe" and tolower(InitiatingProcessFileName) endswith "recover.exe" and tolower(InitiatingProcessFileName) endswith "xcopy.exe")
| where tolower(FileName) == "inproclogger.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(InitiatingProcessFileName) endswith "easpolicymanagerbrokerhost.exe")
| where tolower(FileName) == "iphlpapi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "arp.exe" and tolower(InitiatingProcessFileName) endswith "colorcpl.exe" and tolower(InitiatingProcessFileName) endswith "datausagelivetiletask.exe" and tolower(InitiatingProcessFileName) endswith "dcdiag.exe" and tolower(InitiatingProcessFileName) endswith "devicecensus.exe" and tolower(InitiatingProcessFileName) endswith "dnscacheugc.exe" and tolower(InitiatingProcessFileName) endswith "fxscover.exe" and tolower(InitiatingProcessFileName) endswith "fxssvc.exe" and tolower(InitiatingProcessFileName) endswith "fxsunatd.exe" and tolower(InitiatingProcessFileName) endswith "ipconfig.exe" and tolower(InitiatingProcessFileName) endswith "mousocoreworker.exe" and tolower(InitiatingProcessFileName) endswith "msra.exe" and tolower(InitiatingProcessFileName) endswith "mstsc.exe" and tolower(InitiatingProcessFileName) endswith "nbtstat.exe" and tolower(InitiatingProcessFileName) endswith "net.exe" and tolower(InitiatingProcessFileName) endswith "netbtugc.exe" and tolower(InitiatingProcessFileName) endswith "netiougc.exe" and tolower(InitiatingProcessFileName) endswith "netsh.exe" and tolower(InitiatingProcessFileName) endswith "netstat.exe" and tolower(InitiatingProcessFileName) endswith "omadmclient.exe" and tolower(InitiatingProcessFileName) endswith "pathping.exe" and tolower(InitiatingProcessFileName) endswith "printbrmui.exe" and tolower(InitiatingProcessFileName) endswith "printui.exe" and tolower(InitiatingProcessFileName) endswith "rdpclip.exe" and tolower(InitiatingProcessFileName) endswith "route.exe" and tolower(InitiatingProcessFileName) endswith "tracert.exe" and tolower(InitiatingProcessFileName) endswith "w32tm.exe" and tolower(InitiatingProcessFileName) endswith "wfs.exe" and tolower(InitiatingProcessFileName) endswith "wifitask.exe" and tolower(InitiatingProcessFileName) endswith "wpnpinst.exe" and tolower(InitiatingProcessFileName) endswith "minecraftlauncher.exe")
| where tolower(FileName) == "iri.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "deviceenroller.exe" and tolower(InitiatingProcessFileName) endswith "dmcertinst.exe" and tolower(InitiatingProcessFileName) endswith "dmcfghost.exe" and tolower(InitiatingProcessFileName) endswith "dmomacpmo.exe" and tolower(InitiatingProcessFileName) endswith "hvsievaluator.exe" and tolower(InitiatingProcessFileName) endswith "mdmappinstaller.exe" and tolower(InitiatingProcessFileName) endswith "mdmdiagnosticstool.exe" and tolower(InitiatingProcessFileName) endswith "omadmclient.exe" and tolower(InitiatingProcessFileName) endswith "usocoreworker.exe")
| where tolower(FileName) == "iscsidsc.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "iscsicli.exe")
| where tolower(FileName) == "iscsiexe.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "iscsium.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "iscsicli.exe")
| where tolower(FileName) == "isv.exe_rsaenh.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "iumbase.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(InitiatingProcessFileName) endswith "bioiso.exe" and tolower(InitiatingProcessFileName) endswith "fsiso.exe" and tolower(InitiatingProcessFileName) endswith "ngciso.exe")
| where tolower(FileName) == "iumsdk.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(InitiatingProcessFileName) endswith "bioiso.exe" and tolower(InitiatingProcessFileName) endswith "fsiso.exe" and tolower(InitiatingProcessFileName) endswith "ngciso.exe")
| where tolower(FileName) == "joinutil.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "djoin.exe")
| where tolower(FileName) == "kdstub.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(InitiatingProcessFileName) endswith "hvax64.exe" and tolower(InitiatingProcessFileName) endswith "hvix64.exe")
| where tolower(FileName) == "ksuser.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "mfpmp.exe" and tolower(InitiatingProcessFileName) endswith "osk.exe")
| where tolower(FileName) == "ktmw32.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "ktmutil.exe" and tolower(InitiatingProcessFileName) endswith "msdtc.exe" and tolower(InitiatingProcessFileName) endswith "mstsc.exe" and tolower(InitiatingProcessFileName) endswith "netsh.exe" and tolower(InitiatingProcessFileName) endswith "rstrui.exe" and tolower(InitiatingProcessFileName) endswith "srtasks.exe" and tolower(InitiatingProcessFileName) endswith "wkspbroker.exe")
| where tolower(FileName) == "licensemanagerapi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "wsreset.exe")
| where tolower(FileName) == "licensingdiagspp.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "linkinfo.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "certreq.exe")
| where tolower(FileName) == "loadperf.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "unlodctr.exe")
| where tolower(FileName) == "lockhostingframework.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(InitiatingProcessFileName) endswith "lockapphost.exe")
| where tolower(FileName) == "logoncli.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "certutil.exe" and tolower(InitiatingProcessFileName) endswith "change.exe" and tolower(InitiatingProcessFileName) endswith "chglogon.exe" and tolower(InitiatingProcessFileName) endswith "chgport.exe" and tolower(InitiatingProcessFileName) endswith "csvde.exe" and tolower(InitiatingProcessFileName) endswith "devicecensus.exe" and tolower(InitiatingProcessFileName) endswith "djoin.exe" and tolower(InitiatingProcessFileName) endswith "dsacls.exe" and tolower(InitiatingProcessFileName) endswith "dsmgmt.exe" and tolower(InitiatingProcessFileName) endswith "dsregcmd.exe" and tolower(InitiatingProcessFileName) endswith "efsui.exe" and tolower(InitiatingProcessFileName) endswith "gpfixup.exe" and tolower(InitiatingProcessFileName) endswith "gpresult.exe" and tolower(InitiatingProcessFileName) endswith "klist.exe" and tolower(InitiatingProcessFileName) endswith "ksetup.exe" and tolower(InitiatingProcessFileName) endswith "ldifde.exe" and tolower(InitiatingProcessFileName) endswith "net1.exe" and tolower(InitiatingProcessFileName) endswith "nltest.exe" and tolower(InitiatingProcessFileName) endswith "netdom.exe" and tolower(InitiatingProcessFileName) endswith "ntdsutil.exe" and tolower(InitiatingProcessFileName) endswith "query.exe" and tolower(InitiatingProcessFileName) endswith "quser.exe" and tolower(InitiatingProcessFileName) endswith "qwinsta.exe" and tolower(InitiatingProcessFileName) endswith "redircmp.exe" and tolower(InitiatingProcessFileName) endswith "redirusr.exe" and tolower(InitiatingProcessFileName) endswith "rekeywiz.exe" and tolower(InitiatingProcessFileName) endswith "rendom.exe" and tolower(InitiatingProcessFileName) endswith "repadmin.exe" and tolower(InitiatingProcessFileName) endswith "reset.exe" and tolower(InitiatingProcessFileName) endswith "rwinsta.exe" and tolower(InitiatingProcessFileName) endswith "setspn.exe" and tolower(InitiatingProcessFileName) endswith "systempropertiesadvanced.exe" and tolower(InitiatingProcessFileName) endswith "systemsettingsadminflows.exe" and tolower(InitiatingProcessFileName) endswith "tscon.exe" and tolower(InitiatingProcessFileName) endswith "tskill.exe" and tolower(InitiatingProcessFileName) endswith "w32tm.exe")
| where tolower(FileName) == "logoncontroller.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "lpksetupproxyserv.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "lrwizdll.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(InitiatingProcessFileName) endswith "licmgr.exe")
| where tolower(FileName) == "magnification.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "magnify.exe")
| where tolower(FileName) == "maintenanceui.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(InitiatingProcessFileName) endswith "mschedexe.exe")
| where tolower(FileName) == "mapistub.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "fixmapi.exe")
| where tolower(FileName) == "mbaexmlparser.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(InitiatingProcessFileName) endswith "mbaeparsertask.exe")
| where tolower(FileName) == "mdmdiagnostics.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(InitiatingProcessFileName) endswith "mdmdiagnosticstool.exe")
| where tolower(FileName) == "mfc42u.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "devicepairingwizard.exe" and tolower(InitiatingProcessFileName) endswith "dirquota.exe" and tolower(InitiatingProcessFileName) endswith "eudcedit.exe" and tolower(InitiatingProcessFileName) endswith "filescrn.exe" and tolower(InitiatingProcessFileName) endswith "ldp.exe" and tolower(InitiatingProcessFileName) endswith "msconfig.exe" and tolower(InitiatingProcessFileName) endswith "msinfo32.exe" and tolower(InitiatingProcessFileName) endswith "mspaint.exe" and tolower(InitiatingProcessFileName) endswith "nlbmgr.exe" and tolower(InitiatingProcessFileName) endswith "shrpubw.exe" and tolower(InitiatingProcessFileName) endswith "storrept.exe" and tolower(InitiatingProcessFileName) endswith "verifiergui.exe" and tolower(InitiatingProcessFileName) endswith "wfs.exe")
| where tolower(FileName) == "mfcore.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "mfpmp.exe")
| where tolower(FileName) == "mfplat.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "mdeserver.exe" and tolower(InitiatingProcessFileName) endswith "mfpmp.exe")
| where tolower(FileName) == "mi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "winrs.exe" and tolower(InitiatingProcessFileName) endswith "wsmanhttpconfig.exe" and tolower(InitiatingProcessFileName) endswith "wsmprovhost.exe")
| where tolower(FileName) == "midimap.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "osk.exe")
| where tolower(FileName) == "mintdh.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(InitiatingProcessFileName) endswith "applytrustoffline.exe" and tolower(InitiatingProcessFileName) endswith "netsh.exe" and tolower(InitiatingProcessFileName) endswith "pktmon.exe" and tolower(InitiatingProcessFileName) endswith "plasrv.exe")
| where tolower(FileName) == "miutils.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "register-cimprovider.exe" and tolower(InitiatingProcessFileName) endswith "winrs.exe" and tolower(InitiatingProcessFileName) endswith "wsmanhttpconfig.exe" and tolower(InitiatingProcessFileName) endswith "wsmprovhost.exe")
| where tolower(FileName) == "mlang.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "calc.exe" and tolower(InitiatingProcessFileName) endswith "computerdefaults.exe" and tolower(InitiatingProcessFileName) endswith "fodhelper.exe" and tolower(InitiatingProcessFileName) endswith "ie4uinit.exe")
| where tolower(FileName) == "mmdevapi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "audiodg.exe" and tolower(InitiatingProcessFileName) endswith "osk.exe")
| where tolower(FileName) == "mobilenetworking.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "mbaeparsertask.exe" and tolower(InitiatingProcessFileName) endswith "netsh.exe")
| where tolower(FileName) == "mpclient.dll" and (tolower(FolderPath) !contains "c:\program files\windows defender" and tolower(FolderPath) !contains "%programdata%\microsoft\windows defender\platform\" and tolower(InitiatingProcessFileName) endswith "mpcmdrun.exe" and tolower(InitiatingProcessFileName) endswith "nissrv.exe")
| where tolower(FileName) == "mpr.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "bootcfg.exe" and tolower(InitiatingProcessFileName) endswith "dcdiag.exe" and tolower(InitiatingProcessFileName) endswith "dfsrdiag.exe" and tolower(InitiatingProcessFileName) endswith "driverquery.exe" and tolower(InitiatingProcessFileName) endswith "dsmgmt.exe" and tolower(InitiatingProcessFileName) endswith "eventcreate.exe" and tolower(InitiatingProcessFileName) endswith "getmac.exe" and tolower(InitiatingProcessFileName) endswith "gpresult.exe" and tolower(InitiatingProcessFileName) endswith "iesettingsync.exe" and tolower(InitiatingProcessFileName) endswith "net.exe" and tolower(InitiatingProcessFileName) endswith "ntdsutil.exe" and tolower(InitiatingProcessFileName) endswith "openfiles.exe" and tolower(InitiatingProcessFileName) endswith "pnpunattend.exe" and tolower(InitiatingProcessFileName) endswith "rdpclip.exe" and tolower(InitiatingProcessFileName) endswith "rekeywiz.exe" and tolower(InitiatingProcessFileName) endswith "repadmin.exe" and tolower(InitiatingProcessFileName) endswith "sdclt.exe" and tolower(InitiatingProcessFileName) endswith "setupugc.exe" and tolower(InitiatingProcessFileName) endswith "systeminfo.exe" and tolower(InitiatingProcessFileName) endswith "taskkill.exe" and tolower(InitiatingProcessFileName) endswith "waitfor.exe")
| where tolower(FileName) == "mprapi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "rasautou.exe")
| where tolower(FileName) == "mpsvc.dll" and (tolower(FolderPath) !contains "%programdata%\microsoft\windows defender\platform\" and tolower(InitiatingProcessFileName) endswith "msmpeng.exe")
| where tolower(FileName) == "mrmcorer.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "mcbuilder.exe")
| where tolower(FileName) == "msacm32.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "osk.exe")
| where tolower(FileName) == "mscms.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "colorcpl.exe" and tolower(InitiatingProcessFileName) endswith "dccw.exe")
| where tolower(FileName) == "mscoree.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "aitstatic.exe" and tolower(InitiatingProcessFileName) endswith "presentationhost.exe" and tolower(InitiatingProcessFileName) endswith "applaunch.exe")
| where tolower(FileName) == "mscorsvc.dll" and (tolower(FolderPath) !contains "%windir%\microsoft.net\framework\v" and tolower(FolderPath) !contains "%windir%\microsoft.net\framework64\v" and tolower(InitiatingProcessFileName) endswith "mscorsvw.exe")
| where tolower(FileName) == "msctf.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "msctfmonitor.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "credwiz.exe" and tolower(InitiatingProcessFileName) endswith "ctfmon.exe")
| where tolower(FileName) == "msdrm.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "gamepanel.exe" and tolower(InitiatingProcessFileName) endswith "psr.exe" and tolower(InitiatingProcessFileName) endswith "rmactivate.exe" and tolower(InitiatingProcessFileName) endswith "rmactivate_isv.exe" and tolower(InitiatingProcessFileName) endswith "snippingtool.exe")
| where tolower(FileName) == "msdtctm.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(InitiatingProcessFileName) endswith "msdtc.exe")
| where tolower(FileName) == "msftedit.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "charmap.exe" and tolower(InitiatingProcessFileName) endswith "mspaint.exe")
| where tolower(FileName) == "msi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "dxpserver.exe" and tolower(InitiatingProcessFileName) endswith "fondue.exe" and tolower(InitiatingProcessFileName) endswith "mdmappinstaller.exe" and tolower(InitiatingProcessFileName) endswith "msiexec.exe" and tolower(InitiatingProcessFileName) endswith "optionalfeatures.exe" and tolower(InitiatingProcessFileName) endswith "packageinspector.exe")
| where tolower(FileName) == "msiso.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "browserexport.exe")
| where tolower(FileName) == "msutb.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "ctfmon.exe")
| where tolower(FileName) == "msvcp110_win.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "agentactivationruntimestarter.exe" and tolower(InitiatingProcessFileName) endswith "appidpolicyconverter.exe" and tolower(InitiatingProcessFileName) endswith "dmcertinst.exe" and tolower(InitiatingProcessFileName) endswith "dmomacpmo.exe" and tolower(InitiatingProcessFileName) endswith "locationnotificationwindows.exe" and tolower(InitiatingProcessFileName) endswith "mdmagent.exe" and tolower(InitiatingProcessFileName) endswith "mdmappinstaller.exe" and tolower(InitiatingProcessFileName) endswith "omadmclient.exe" and tolower(InitiatingProcessFileName) endswith "provlaunch.exe" and tolower(InitiatingProcessFileName) endswith "provtool.exe" and tolower(InitiatingProcessFileName) endswith "windowsactiondialog.exe")
| where tolower(FileName) == "msvcr100.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "javacpl.exe" and tolower(InitiatingProcessFileName) endswith "winword.exe")
| where tolower(FileName) == "mswb7.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "mswsock.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "alg.exe" and tolower(InitiatingProcessFileName) endswith "finger.exe" and tolower(InitiatingProcessFileName) endswith "fsquirt.exe" and tolower(InitiatingProcessFileName) endswith "nbtstat.exe")
| where tolower(FileName) == "msxml3.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "mtxclu.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "msdtc.exe")
| where tolower(FileName) == "napinsp.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "ncrypt.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "certreq.exe" and tolower(InitiatingProcessFileName) endswith "certutil.exe" and tolower(InitiatingProcessFileName) endswith "clipup.exe" and tolower(InitiatingProcessFileName) endswith "dmcertinst.exe" and tolower(InitiatingProcessFileName) endswith "dnscmd.exe" and tolower(InitiatingProcessFileName) endswith "dsregcmd.exe" and tolower(InitiatingProcessFileName) endswith "sgrmbroker.exe")
| where tolower(FileName) == "ndfapi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "msra.exe" and tolower(InitiatingProcessFileName) endswith "netsh.exe")
| where tolower(FileName) == "netapi32.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "appvclient.exe" and tolower(InitiatingProcessFileName) endswith "bootcfg.exe" and tolower(InitiatingProcessFileName) endswith "certutil.exe" and tolower(InitiatingProcessFileName) endswith "dcdiag.exe" and tolower(InitiatingProcessFileName) endswith "dfscmd.exe" and tolower(InitiatingProcessFileName) endswith "dfsdiag.exe" and tolower(InitiatingProcessFileName) endswith "dfsrdiag.exe" and tolower(InitiatingProcessFileName) endswith "dfsutil.exe" and tolower(InitiatingProcessFileName) endswith "dnscmd.exe" and tolower(InitiatingProcessFileName) endswith "dsadd.exe" and tolower(InitiatingProcessFileName) endswith "dsget.exe" and tolower(InitiatingProcessFileName) endswith "dsquery.exe" and tolower(InitiatingProcessFileName) endswith "ie4uinit.exe" and tolower(InitiatingProcessFileName) endswith "mstsc.exe" and tolower(InitiatingProcessFileName) endswith "qappsrv.exe" and tolower(InitiatingProcessFileName) endswith "spaceagent.exe" and tolower(InitiatingProcessFileName) endswith "wbengine.exe")
| where tolower(FileName) == "netid.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "systempropertiesadvanced.exe")
| where tolower(FileName) == "netiohlp.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "netsh.exe")
| where tolower(FileName) == "netjoin.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "netdom.exe")
| where tolower(FileName) == "netplwiz.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "netplwiz.exe")
| where tolower(FileName) == "netprofm.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "netprovfw.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "djoin.exe")
| where tolower(FileName) == "netsetupapi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "netshell.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "netsh.exe")
| where tolower(FileName) == "nettrace.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(InitiatingProcessFileName) endswith "netsh.exe")
| where tolower(FileName) == "netutils.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "at.exe" and tolower(InitiatingProcessFileName) endswith "certutil.exe" and tolower(InitiatingProcessFileName) endswith "change.exe" and tolower(InitiatingProcessFileName) endswith "chglogon.exe" and tolower(InitiatingProcessFileName) endswith "chgport.exe" and tolower(InitiatingProcessFileName) endswith "credwiz.exe" and tolower(InitiatingProcessFileName) endswith "csvde.exe" and tolower(InitiatingProcessFileName) endswith "dcdiag.exe" and tolower(InitiatingProcessFileName) endswith "devicecensus.exe" and tolower(InitiatingProcessFileName) endswith "deviceenroller.exe" and tolower(InitiatingProcessFileName) endswith "djoin.exe" and tolower(InitiatingProcessFileName) endswith "dpapimig.exe" and tolower(InitiatingProcessFileName) endswith "driverquery.exe" and tolower(InitiatingProcessFileName) endswith "dsacls.exe" and tolower(InitiatingProcessFileName) endswith "dsdbutil.exe" and tolower(InitiatingProcessFileName) endswith "dsmgmt.exe" and tolower(InitiatingProcessFileName) endswith "dsregcmd.exe" and tolower(InitiatingProcessFileName) endswith "easinvoker.exe" and tolower(InitiatingProcessFileName) endswith "edpcleanup.exe" and tolower(InitiatingProcessFileName) endswith "efsui.exe" and tolower(InitiatingProcessFileName) endswith "eventcreate.exe" and tolower(InitiatingProcessFileName) endswith "getmac.exe" and tolower(InitiatingProcessFileName) endswith "gpfixup.exe" and tolower(InitiatingProcessFileName) endswith "gpresult.exe" and tolower(InitiatingProcessFileName) endswith "ie4uinit.exe" and tolower(InitiatingProcessFileName) endswith "klist.exe" and tolower(InitiatingProcessFileName) endswith "ksetup.exe" and tolower(InitiatingProcessFileName) endswith "ldifde.exe" and tolower(InitiatingProcessFileName) endswith "mshta.exe" and tolower(InitiatingProcessFileName) endswith "mstsc.exe" and tolower(InitiatingProcessFileName) endswith "net.exe" and tolower(InitiatingProcessFileName) endswith "net1.exe" and tolower(InitiatingProcessFileName) endswith "netdom.exe" and tolower(InitiatingProcessFileName) endswith "netplwiz.exe" and tolower(InitiatingProcessFileName) endswith "nltest.exe" and tolower(InitiatingProcessFileName) endswith "ntdsutil.exe" and tolower(InitiatingProcessFileName) endswith "openfiles.exe" and tolower(InitiatingProcessFileName) endswith "query.exe" and tolower(InitiatingProcessFileName) endswith "quser.exe" and tolower(InitiatingProcessFileName) endswith "qwinsta.exe" and tolower(InitiatingProcessFileName) endswith "raserver.exe" and tolower(InitiatingProcessFileName) endswith "redircmp.exe" and tolower(InitiatingProcessFileName) endswith "redirusr.exe" and tolower(InitiatingProcessFileName) endswith "rekeywiz.exe" and tolower(InitiatingProcessFileName) endswith "rendom.exe" and tolower(InitiatingProcessFileName) endswith "repadmin.exe" and tolower(InitiatingProcessFileName) endswith "reset.exe" and tolower(InitiatingProcessFileName) endswith "runas.exe" and tolower(InitiatingProcessFileName) endswith "rwinsta.exe" and tolower(InitiatingProcessFileName) endswith "setspn.exe" and tolower(InitiatingProcessFileName) endswith "shrpubw.exe" and tolower(InitiatingProcessFileName) endswith "spaceagent.exe" and tolower(InitiatingProcessFileName) endswith "systempropertiesadvanced.exe" and tolower(InitiatingProcessFileName) endswith "systemsettingsadminflows.exe" and tolower(InitiatingProcessFileName) endswith "taskkill.exe" and tolower(InitiatingProcessFileName) endswith "tasklist.exe" and tolower(InitiatingProcessFileName) endswith "tscon.exe" and tolower(InitiatingProcessFileName) endswith "tskill.exe" and tolower(InitiatingProcessFileName) endswith "w32tm.exe" and tolower(InitiatingProcessFileName) endswith "waitfor.exe" and tolower(InitiatingProcessFileName) endswith "wbengine.exe" and tolower(InitiatingProcessFileName) endswith "whoami.exe")
| where tolower(FileName) == "networkexplorer.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "newdev.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "infdefaultinstall.exe" and tolower(InitiatingProcessFileName) endswith "pnpunattend.exe" and tolower(InitiatingProcessFileName) endswith "systemsettingsadminflows.exe")
| where tolower(FileName) == "ninput.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "multidigimon.exe" and tolower(InitiatingProcessFileName) endswith "tabcal.exe")
| where tolower(FileName) == "nlaapi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "netsh.exe")
| where tolower(FileName) == "nlansp_c.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "npmproxy.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "nshhttp.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "netsh.exe")
| where tolower(FileName) == "nshipsec.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "netsh.exe")
| where tolower(FileName) == "nshwfp.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "netsh.exe")
| where tolower(FileName) == "ntdsapi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "certutil.exe" and tolower(InitiatingProcessFileName) endswith "cipher.exe" and tolower(InitiatingProcessFileName) endswith "dcdiag.exe" and tolower(InitiatingProcessFileName) endswith "dfsrdiag.exe" and tolower(InitiatingProcessFileName) endswith "dnscmd.exe" and tolower(InitiatingProcessFileName) endswith "dsacls.exe" and tolower(InitiatingProcessFileName) endswith "dsadd.exe" and tolower(InitiatingProcessFileName) endswith "dsdbutil.exe" and tolower(InitiatingProcessFileName) endswith "dsget.exe" and tolower(InitiatingProcessFileName) endswith "dsmgmt.exe" and tolower(InitiatingProcessFileName) endswith "dsquery.exe" and tolower(InitiatingProcessFileName) endswith "gpresult.exe" and tolower(InitiatingProcessFileName) endswith "licmgr.exe" and tolower(InitiatingProcessFileName) endswith "netdom.exe" and tolower(InitiatingProcessFileName) endswith "nltest.exe" and tolower(InitiatingProcessFileName) endswith "ntdsutil.exe" and tolower(InitiatingProcessFileName) endswith "rendom.exe" and tolower(InitiatingProcessFileName) endswith "repadmin.exe" and tolower(InitiatingProcessFileName) endswith "setspn.exe" and tolower(InitiatingProcessFileName) endswith "w32tm.exe")
| where tolower(FileName) == "ntlanman.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "ntlmshared.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "at.exe")
| where tolower(FileName) == "ntmarta.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "cacls.exe")
| where tolower(FileName) == "ntshrui.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "oleacc.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "bootim.exe" and tolower(InitiatingProcessFileName) endswith "cttune.exe" and tolower(InitiatingProcessFileName) endswith "devicepairingwizard.exe" and tolower(InitiatingProcessFileName) endswith "easeofaccessdialog.exe" and tolower(InitiatingProcessFileName) endswith "fsquirt.exe" and tolower(InitiatingProcessFileName) endswith "magnify.exe" and tolower(InitiatingProcessFileName) endswith "optionalfeatures.exe" and tolower(InitiatingProcessFileName) endswith "osk.exe" and tolower(InitiatingProcessFileName) endswith "psr.exe" and tolower(InitiatingProcessFileName) endswith "sethc.exe" and tolower(InitiatingProcessFileName) endswith "snippingtool.exe" and tolower(InitiatingProcessFileName) endswith "utilman.exe" and tolower(InitiatingProcessFileName) endswith "wmpdmc.exe")
| where tolower(FileName) == "omadmapi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "deviceenroller.exe" and tolower(InitiatingProcessFileName) endswith "dmcertinst.exe" and tolower(InitiatingProcessFileName) endswith "dmcfghost.exe" and tolower(InitiatingProcessFileName) endswith "dmomacpmo.exe" and tolower(InitiatingProcessFileName) endswith "hvsievaluator.exe" and tolower(InitiatingProcessFileName) endswith "mdmagent.exe" and tolower(InitiatingProcessFileName) endswith "mdmappinstaller.exe" and tolower(InitiatingProcessFileName) endswith "mdmdiagnosticstool.exe" and tolower(InitiatingProcessFileName) endswith "omadmclient.exe" and tolower(InitiatingProcessFileName) endswith "omadmrpc.exe" and tolower(InitiatingProcessFileName) endswith "usocoreworker.exe")
| where tolower(FileName) == "onex.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "netsh.exe")
| where tolower(FileName) == "opcservices.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "proximityuxhost.exe")
| where tolower(FileName) == "osbaseln.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "fondue.exe" and tolower(InitiatingProcessFileName) endswith "optionalfeatures.exe")
| where tolower(FileName) == "osksupport.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(InitiatingProcessFileName) endswith "osk.exe")
| where tolower(FileName) == "osuninst.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "convert.exe" and tolower(InitiatingProcessFileName) endswith "vds.exe")
| where tolower(FileName) == "p2p.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "netsh.exe")
| where tolower(FileName) == "p2pnetsh.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "netsh.exe")
| where tolower(FileName) == "p9np.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "pcaui.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "pcaui.exe" and tolower(InitiatingProcessFileName) endswith "pcalua.exe")
| where tolower(FileName) == "pdh.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "plasrv.exe" and tolower(InitiatingProcessFileName) endswith "relog.exe" and tolower(InitiatingProcessFileName) endswith "taskmgr.exe" and tolower(InitiatingProcessFileName) endswith "tracerpt.exe" and tolower(InitiatingProcessFileName) endswith "typeperf.exe")
| where tolower(FileName) == "peerdistsh.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "netsh.exe")
| where tolower(FileName) == "pkeyhelper.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(InitiatingProcessFileName) endswith "sppsvc.exe")
| where tolower(FileName) == "pla.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "playsndsrv.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "sethc.exe")
| where tolower(FileName) == "pnrpnsp.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "policymanager.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "displayswitch.exe" and tolower(InitiatingProcessFileName) endswith "easpolicymanagerbrokerhost.exe" and tolower(InitiatingProcessFileName) endswith "edpcleanup.exe" and tolower(InitiatingProcessFileName) endswith "eduprintprov.exe" and tolower(InitiatingProcessFileName) endswith "hvsievaluator.exe" and tolower(InitiatingProcessFileName) endswith "mdmdiagnosticstool.exe" and tolower(InitiatingProcessFileName) endswith "omadmclient.exe" and tolower(InitiatingProcessFileName) endswith "settingsynchost.exe" and tolower(InitiatingProcessFileName) endswith "workfolders.exe")
| where tolower(FileName) == "polstore.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "netsh.exe")
| where tolower(FileName) == "powrprof.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "fsquirt.exe" and tolower(InitiatingProcessFileName) endswith "msinfo32.exe" and tolower(InitiatingProcessFileName) endswith "printfilterpipelinesvc.exe" and tolower(InitiatingProcessFileName) endswith "sfc.exe")
| where tolower(FileName) == "printui.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "printui.exe")
| where tolower(FileName) == "prntvpt.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "printfilterpipelinesvc.exe")
| where tolower(FileName) == "profapi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "certreq.exe" and tolower(InitiatingProcessFileName) endswith "edpcleanup.exe" and tolower(InitiatingProcessFileName) endswith "immersivetpmvscmgrsvr.exe" and tolower(InitiatingProcessFileName) endswith "manage-bde.exe" and tolower(InitiatingProcessFileName) endswith "mousocoreworker.exe" and tolower(InitiatingProcessFileName) endswith "omadmclient.exe" and tolower(InitiatingProcessFileName) endswith "provtool.exe" and tolower(InitiatingProcessFileName) endswith "rmttpmvscmgrsvr.exe" and tolower(InitiatingProcessFileName) endswith "tpmvscmgrsvr.exe" and tolower(InitiatingProcessFileName) endswith "usocoreworker.exe" and tolower(InitiatingProcessFileName) endswith "wwahost.exe" and tolower(InitiatingProcessFileName) endswith "write.exe")
| where tolower(FileName) == "propsys.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "bootim.exe" and tolower(InitiatingProcessFileName) endswith "calc.exe" and tolower(InitiatingProcessFileName) endswith "colorcpl.exe" and tolower(InitiatingProcessFileName) endswith "compmgmtlauncher.exe" and tolower(InitiatingProcessFileName) endswith "computerdefaults.exe" and tolower(InitiatingProcessFileName) endswith "customshellhost.exe" and tolower(InitiatingProcessFileName) endswith "dpiscaling.exe" and tolower(InitiatingProcessFileName) endswith "dsregcmd.exe" and tolower(InitiatingProcessFileName) endswith "dxpserver.exe" and tolower(InitiatingProcessFileName) endswith "fodhelper.exe" and tolower(InitiatingProcessFileName) endswith "fondue.exe" and tolower(InitiatingProcessFileName) endswith "fxssvc.exe" and tolower(InitiatingProcessFileName) endswith "fxsunatd.exe" and tolower(InitiatingProcessFileName) endswith "mobsync.exe" and tolower(InitiatingProcessFileName) endswith "mspaint.exe" and tolower(InitiatingProcessFileName) endswith "netplwiz.exe" and tolower(InitiatingProcessFileName) endswith "optionalfeatures.exe" and tolower(InitiatingProcessFileName) endswith "pinenrollmentbroker.exe" and tolower(InitiatingProcessFileName) endswith "printbrmui.exe" and tolower(InitiatingProcessFileName) endswith "printui.exe" and tolower(InitiatingProcessFileName) endswith "proximityuxhost.exe" and tolower(InitiatingProcessFileName) endswith "quickassist.exe" and tolower(InitiatingProcessFileName) endswith "rdpclip.exe" and tolower(InitiatingProcessFileName) endswith "resmon.exe" and tolower(InitiatingProcessFileName) endswith "sdclt.exe" and tolower(InitiatingProcessFileName) endswith "settingsynchost.exe" and tolower(InitiatingProcessFileName) endswith "slui.exe" and tolower(InitiatingProcessFileName) endswith "synchost.exe" and tolower(InitiatingProcessFileName) endswith "systemsettingsadminflows.exe" and tolower(InitiatingProcessFileName) endswith "wfs.exe" and tolower(InitiatingProcessFileName) endswith "wkspbroker.exe" and tolower(InitiatingProcessFileName) endswith "workfolders.exe" and tolower(InitiatingProcessFileName) endswith "wpnpinst.exe" and tolower(InitiatingProcessFileName) endswith "write.exe")
| where tolower(FileName) == "proximitycommon.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "proximityuxhost.exe")
| where tolower(FileName) == "proximityservicepal.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(InitiatingProcessFileName) endswith "proximityuxhost.exe")
| where tolower(FileName) == "prvdmofcomp.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "register-cimprovider.exe")
| where tolower(FileName) == "puiapi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "printui.exe")
| where tolower(FileName) == "radcui.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "wkspbroker.exe")
| where tolower(FileName) == "rasapi32.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "cmdl32.exe" and tolower(InitiatingProcessFileName) endswith "nethost.exe" and tolower(InitiatingProcessFileName) endswith "netsh.exe" and tolower(InitiatingProcessFileName) endswith "rasdial.exe")
| where tolower(FileName) == "rasdlg.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "rasautou.exe")
| where tolower(FileName) == "rasgcw.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "rasman.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "cmdl32.exe" and tolower(InitiatingProcessFileName) endswith "nethost.exe" and tolower(InitiatingProcessFileName) endswith "netsh.exe" and tolower(InitiatingProcessFileName) endswith "rasautou.exe" and tolower(InitiatingProcessFileName) endswith "rasdial.exe")
| where tolower(FileName) == "rasmontr.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "netsh.exe")
| where tolower(FileName) == "reagent.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "bootim.exe" and tolower(InitiatingProcessFileName) endswith "reagentc.exe" and tolower(InitiatingProcessFileName) endswith "recdisc.exe" and tolower(InitiatingProcessFileName) endswith "recoverydrive.exe" and tolower(InitiatingProcessFileName) endswith "relpost.exe" and tolower(InitiatingProcessFileName) endswith "resetengine.exe" and tolower(InitiatingProcessFileName) endswith "sdclt.exe" and tolower(InitiatingProcessFileName) endswith "systemreset.exe")
| where tolower(FileName) == "regapi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "change.exe" and tolower(InitiatingProcessFileName) endswith "chglogon.exe" and tolower(InitiatingProcessFileName) endswith "query.exe" and tolower(InitiatingProcessFileName) endswith "reset.exe")
| where tolower(FileName) == "reseteng.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(InitiatingProcessFileName) endswith "bootim.exe")
| where tolower(FileName) == "resetengine.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(InitiatingProcessFileName) endswith "resetengine.exe" and tolower(InitiatingProcessFileName) endswith "systemreset.exe")
| where tolower(FileName) == "resutils.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "dfsdiag.exe" and tolower(InitiatingProcessFileName) endswith "msdtc.exe")
| where tolower(FileName) == "rjvplatform.dll" and (tolower(FolderPath) !contains "c:\windows\system32\systemresetplatform" and tolower(FolderPath) !contains "c:\windows\syswow64\systemresetplatform" and tolower(InitiatingProcessFileName) endswith "systemresetplatform.exe")
| where tolower(FileName) == "rmclient.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "netsh.exe" and tolower(InitiatingProcessFileName) endswith "runtimebroker.exe")
| where tolower(FileName) == "rpcnsh.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "netsh.exe")
| where tolower(FileName) == "rsaenh.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "rtutils.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "dialer.exe" and tolower(InitiatingProcessFileName) endswith "nethost.exe" and tolower(InitiatingProcessFileName) endswith "rasautou.exe" and tolower(InitiatingProcessFileName) endswith "rasdial.exe" and tolower(InitiatingProcessFileName) endswith "rasphone.exe")
| where tolower(FileName) == "rtworkq.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "mdeserver.exe" and tolower(InitiatingProcessFileName) endswith "mfpmp.exe")
| where tolower(FileName) == "samcli.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "certutil.exe" and tolower(InitiatingProcessFileName) endswith "change.exe" and tolower(InitiatingProcessFileName) endswith "chglogon.exe" and tolower(InitiatingProcessFileName) endswith "chgport.exe" and tolower(InitiatingProcessFileName) endswith "credwiz.exe" and tolower(InitiatingProcessFileName) endswith "dcdiag.exe" and tolower(InitiatingProcessFileName) endswith "deviceenroller.exe" and tolower(InitiatingProcessFileName) endswith "dpapimig.exe" and tolower(InitiatingProcessFileName) endswith "easinvoker.exe" and tolower(InitiatingProcessFileName) endswith "net.exe" and tolower(InitiatingProcessFileName) endswith "net1.exe" and tolower(InitiatingProcessFileName) endswith "netdom.exe" and tolower(InitiatingProcessFileName) endswith "netplwiz.exe" and tolower(InitiatingProcessFileName) endswith "query.exe" and tolower(InitiatingProcessFileName) endswith "quser.exe" and tolower(InitiatingProcessFileName) endswith "qwinsta.exe" and tolower(InitiatingProcessFileName) endswith "raserver.exe" and tolower(InitiatingProcessFileName) endswith "reset.exe" and tolower(InitiatingProcessFileName) endswith "rwinsta.exe" and tolower(InitiatingProcessFileName) endswith "systemsettingsadminflows.exe" and tolower(InitiatingProcessFileName) endswith "tscon.exe" and tolower(InitiatingProcessFileName) endswith "tskill.exe" and tolower(InitiatingProcessFileName) endswith "wpcmon.exe")
| where tolower(FileName) == "samlib.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "dpapimig.exe" and tolower(InitiatingProcessFileName) endswith "dsmgmt.exe" and tolower(InitiatingProcessFileName) endswith "easinvoker.exe" and tolower(InitiatingProcessFileName) endswith "netplwiz.exe" and tolower(InitiatingProcessFileName) endswith "ntdsutil.exe")
| where tolower(FileName) == "sapi_onecore.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "sas.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "quickassist.exe")
| where tolower(FileName) == "scansetting.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "wiaacmgr.exe" and tolower(InitiatingProcessFileName) endswith "wiawow64.exe")
| where tolower(FileName) == "scecli.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "convert.exe" and tolower(InitiatingProcessFileName) endswith "secedit.exe")
| where tolower(FileName) == "schedcli.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "at.exe")
| where tolower(FileName) == "secur32.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "appvclient.exe" and tolower(InitiatingProcessFileName) endswith "calc.exe" and tolower(InitiatingProcessFileName) endswith "certreq.exe" and tolower(InitiatingProcessFileName) endswith "certutil.exe" and tolower(InitiatingProcessFileName) endswith "computerdefaults.exe" and tolower(InitiatingProcessFileName) endswith "dfsrdiag.exe" and tolower(InitiatingProcessFileName) endswith "dsregcmd.exe" and tolower(InitiatingProcessFileName) endswith "dsrm.exe" and tolower(InitiatingProcessFileName) endswith "fodhelper.exe" and tolower(InitiatingProcessFileName) endswith "gpresult.exe" and tolower(InitiatingProcessFileName) endswith "klist.exe" and tolower(InitiatingProcessFileName) endswith "msdt.exe" and tolower(InitiatingProcessFileName) endswith "repadmin.exe" and tolower(InitiatingProcessFileName) endswith "consent.exe")
| where tolower(FileName) == "security.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "telnet.exe")
| where tolower(FileName) == "sensapi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "minecraftlauncher.exe")
| where tolower(FileName) == "shell32.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "slc.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "msinfo32.exe" and tolower(InitiatingProcessFileName) endswith "netsh.exe" and tolower(InitiatingProcessFileName) endswith "packageinspector.exe" and tolower(InitiatingProcessFileName) endswith "phoneactivate.exe" and tolower(InitiatingProcessFileName) endswith "slui.exe")
| where tolower(FileName) == "snmpapi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "arp.exe" and tolower(InitiatingProcessFileName) endswith "netstat.exe")
| where tolower(FileName) == "spectrumsyncclient.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(InitiatingProcessFileName) endswith "spectrum.exe")
| where tolower(FileName) == "spp.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "rstrui.exe" and tolower(InitiatingProcessFileName) endswith "sdclt.exe" and tolower(InitiatingProcessFileName) endswith "srtasks.exe" and tolower(InitiatingProcessFileName) endswith "wbengine.exe")
| where tolower(FileName) == "sppc.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "msinfo32.exe" and tolower(InitiatingProcessFileName) endswith "netsh.exe" and tolower(InitiatingProcessFileName) endswith "packageinspector.exe" and tolower(InitiatingProcessFileName) endswith "slui.exe")
| where tolower(FileName) == "sppcext.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "phoneactivate.exe")
| where tolower(FileName) == "srclient.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "srtasks.exe" and tolower(InitiatingProcessFileName) endswith "tiworker.exe")
| where tolower(FileName) == "srcore.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(InitiatingProcessFileName) endswith "rstrui.exe" and tolower(InitiatingProcessFileName) endswith "srtasks.exe")
| where tolower(FileName) == "srmtrace.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "dirquota.exe" and tolower(InitiatingProcessFileName) endswith "filescrn.exe" and tolower(InitiatingProcessFileName) endswith "storrept.exe")
| where tolower(FileName) == "srpapi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "appidpolicyconverter.exe" and tolower(InitiatingProcessFileName) endswith "mshta.exe" and tolower(InitiatingProcessFileName) endswith "rdpclip.exe")
| where tolower(FileName) == "srvcli.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "change.exe" and tolower(InitiatingProcessFileName) endswith "chglogon.exe" and tolower(InitiatingProcessFileName) endswith "chgport.exe" and tolower(InitiatingProcessFileName) endswith "dcdiag.exe" and tolower(InitiatingProcessFileName) endswith "dsdbutil.exe" and tolower(InitiatingProcessFileName) endswith "driverquery.exe" and tolower(InitiatingProcessFileName) endswith "eventcreate.exe" and tolower(InitiatingProcessFileName) endswith "getmac.exe" and tolower(InitiatingProcessFileName) endswith "gpresult.exe" and tolower(InitiatingProcessFileName) endswith "ksetup.exe" and tolower(InitiatingProcessFileName) endswith "net.exe" and tolower(InitiatingProcessFileName) endswith "net1.exe" and tolower(InitiatingProcessFileName) endswith "netdom.exe" and tolower(InitiatingProcessFileName) endswith "ntdsutil.exe" and tolower(InitiatingProcessFileName) endswith "openfiles.exe" and tolower(InitiatingProcessFileName) endswith "query.exe" and tolower(InitiatingProcessFileName) endswith "quser.exe" and tolower(InitiatingProcessFileName) endswith "qwinsta.exe" and tolower(InitiatingProcessFileName) endswith "reset.exe" and tolower(InitiatingProcessFileName) endswith "rwinsta.exe" and tolower(InitiatingProcessFileName) endswith "shrpubw.exe" and tolower(InitiatingProcessFileName) endswith "spaceagent.exe" and tolower(InitiatingProcessFileName) endswith "systempropertiesadvanced.exe" and tolower(InitiatingProcessFileName) endswith "taskkill.exe" and tolower(InitiatingProcessFileName) endswith "tasklist.exe" and tolower(InitiatingProcessFileName) endswith "tscon.exe" and tolower(InitiatingProcessFileName) endswith "tskill.exe" and tolower(InitiatingProcessFileName) endswith "waitfor.exe" and tolower(InitiatingProcessFileName) endswith "wbengine.exe")
| where tolower(FileName) == "ssp.exe_rsaenh.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "ssp_isv.exe_rsaenh.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "sspicli.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "at.exe" and tolower(InitiatingProcessFileName) endswith "bitsadmin.exe" and tolower(InitiatingProcessFileName) endswith "bootcfg.exe" and tolower(InitiatingProcessFileName) endswith "calc.exe" and tolower(InitiatingProcessFileName) endswith "certreq.exe" and tolower(InitiatingProcessFileName) endswith "certutil.exe" and tolower(InitiatingProcessFileName) endswith "computerdefaults.exe" and tolower(InitiatingProcessFileName) endswith "credentialenrollmentmanager.exe" and tolower(InitiatingProcessFileName) endswith "customshellhost.exe" and tolower(InitiatingProcessFileName) endswith "deviceenroller.exe" and tolower(InitiatingProcessFileName) endswith "dialer.exe" and tolower(InitiatingProcessFileName) endswith "driverquery.exe" and tolower(InitiatingProcessFileName) endswith "dsregcmd.exe" and tolower(InitiatingProcessFileName) endswith "edpcleanup.exe" and tolower(InitiatingProcessFileName) endswith "eduprintprov.exe" and tolower(InitiatingProcessFileName) endswith "eventcreate.exe" and tolower(InitiatingProcessFileName) endswith "fodhelper.exe" and tolower(InitiatingProcessFileName) endswith "ftp.exe" and tolower(InitiatingProcessFileName) endswith "getmac.exe" and tolower(InitiatingProcessFileName) endswith "gpresult.exe" and tolower(InitiatingProcessFileName) endswith "iesettingsync.exe" and tolower(InitiatingProcessFileName) endswith "klist.exe" and tolower(InitiatingProcessFileName) endswith "ksetup.exe" and tolower(InitiatingProcessFileName) endswith "ldp.exe" and tolower(InitiatingProcessFileName) endswith "logman.exe" and tolower(InitiatingProcessFileName) endswith "mdeserver.exe" and tolower(InitiatingProcessFileName) endswith "msdt.exe" and tolower(InitiatingProcessFileName) endswith "mshta.exe" and tolower(InitiatingProcessFileName) endswith "msra.exe" and tolower(InitiatingProcessFileName) endswith "mstsc.exe" and tolower(InitiatingProcessFileName) endswith "mtstocom.exe" and tolower(InitiatingProcessFileName) endswith "muiunattend.exe" and tolower(InitiatingProcessFileName) endswith "netdom.exe" and tolower(InitiatingProcessFileName) endswith "netsh.exe" and tolower(InitiatingProcessFileName) endswith "openfiles.exe" and tolower(InitiatingProcessFileName) endswith "perfmon.exe" and tolower(InitiatingProcessFileName) endswith "pinenrollmentbroker.exe" and tolower(InitiatingProcessFileName) endswith "presentationsettings.exe" and tolower(InitiatingProcessFileName) endswith "psr.exe" and tolower(InitiatingProcessFileName) endswith "quickassist.exe" and tolower(InitiatingProcessFileName) endswith "rdpsa.exe" and tolower(InitiatingProcessFileName) endswith "rpcping.exe" and tolower(InitiatingProcessFileName) endswith "runas.exe" and tolower(InitiatingProcessFileName) endswith "sdclt.exe" and tolower(InitiatingProcessFileName) endswith "setx.exe" and tolower(InitiatingProcessFileName) endswith "shutdown.exe" and tolower(InitiatingProcessFileName) endswith "systeminfo.exe" and tolower(InitiatingProcessFileName) endswith "systemsettingsadminflows.exe" and tolower(InitiatingProcessFileName) endswith "takeown.exe" and tolower(InitiatingProcessFileName) endswith "taskkill.exe" and tolower(InitiatingProcessFileName) endswith "tasklist.exe" and tolower(InitiatingProcessFileName) endswith "waitfor.exe" and tolower(InitiatingProcessFileName) endswith "whoami.exe" and tolower(InitiatingProcessFileName) endswith "wkspbroker.exe" and tolower(InitiatingProcessFileName) endswith "wlrmdr.exe")
| where tolower(FileName) == "ssshim.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "sfc.exe")
| where tolower(FileName) == "staterepository.core.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "applytrustoffline.exe" and tolower(InitiatingProcessFileName) endswith "lpremove.exe" and tolower(InitiatingProcessFileName) endswith "systemsettingsadminflows.exe")
| where tolower(FileName) == "structuredquery.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "sxshared.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "defrag.exe" and tolower(InitiatingProcessFileName) endswith "dfrgui.exe")
| where tolower(FileName) == "systemsettingsthresholdadminflowui.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(InitiatingProcessFileName) endswith "systemsettingsadminflows.exe")
| where tolower(FileName) == "tapi32.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "dialer.exe" and tolower(InitiatingProcessFileName) endswith "fxssvc.exe" and tolower(InitiatingProcessFileName) endswith "tcmsetup.exe")
| where tolower(FileName) == "tbs.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "bootim.exe" and tolower(InitiatingProcessFileName) endswith "mdmdiagnosticstool.exe" and tolower(InitiatingProcessFileName) endswith "resetengine.exe" and tolower(InitiatingProcessFileName) endswith "sgrmbroker.exe" and tolower(InitiatingProcessFileName) endswith "systemreset.exe" and tolower(InitiatingProcessFileName) endswith "tpmtool.exe")
| where tolower(FileName) == "tdh.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "plasrv.exe")
| where tolower(FileName) == "textshaping.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "logger.exe" and tolower(InitiatingProcessFileName) endswith "logviewer.exe")
| where tolower(FileName) == "timesync.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(InitiatingProcessFileName) endswith "systemsettingsadminflows.exe")
| where tolower(FileName) == "tpmcoreprovisioning.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "tpmtool.exe")
| where tolower(FileName) == "tquery.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "searchfilterhost.exe" and tolower(InitiatingProcessFileName) endswith "searchprotocolhost.exe")
| where tolower(FileName) == "tsworkspace.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "wkspbroker.exe")
| where tolower(FileName) == "ttdrecord.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "tttracer.exe")
| where tolower(FileName) == "twext.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "twinapi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "dataexchangehost.exe")
| where tolower(FileName) == "twinui.appcore.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "uianimation.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "uiautomationcore.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "gamepanel.exe" and tolower(InitiatingProcessFileName) endswith "magnify.exe")
| where tolower(FileName) == "uireng.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "psr.exe")
| where tolower(FileName) == "uiribbon.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "umpdc.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "deviceenroller.exe" and tolower(InitiatingProcessFileName) endswith "dmcertinst.exe" and tolower(InitiatingProcessFileName) endswith "iesettingsync.exe" and tolower(InitiatingProcessFileName) endswith "mousocoreworker.exe" and tolower(InitiatingProcessFileName) endswith "netevtfwdr.exe" and tolower(InitiatingProcessFileName) endswith "omadmclient.exe" and tolower(InitiatingProcessFileName) endswith "settingsynchost.exe" and tolower(InitiatingProcessFileName) endswith "usocoreworker.exe" and tolower(InitiatingProcessFileName) endswith "wifitask.exe" and tolower(InitiatingProcessFileName) endswith "runtimebroker.exe")
| where tolower(FileName) == "unattend.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(InitiatingProcessFileName) endswith "recoverydrive.exe")
| where tolower(FileName) == "updatepolicy.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "mousocoreworker.exe" and tolower(InitiatingProcessFileName) endswith "musnotification.exe" and tolower(InitiatingProcessFileName) endswith "musnotificationux.exe" and tolower(InitiatingProcessFileName) endswith "usoclient.exe" and tolower(InitiatingProcessFileName) endswith "usocoreworker.exe")
| where tolower(FileName) == "upshared.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(InitiatingProcessFileName) endswith "musnotification.exe" and tolower(InitiatingProcessFileName) endswith "musnotificationux.exe" and tolower(InitiatingProcessFileName) endswith "musnotifyicon.exe")
| where tolower(FileName) == "urlmon.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "bytecodegenerator.exe" and tolower(InitiatingProcessFileName) endswith "ie4uinit.exe" and tolower(InitiatingProcessFileName) endswith "ldifde.exe" and tolower(InitiatingProcessFileName) endswith "presentationhost.exe" and tolower(InitiatingProcessFileName) endswith "write.exe")
| where tolower(FileName) == "userenv.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "appidpolicyconverter.exe" and tolower(InitiatingProcessFileName) endswith "appvclient.exe" and tolower(InitiatingProcessFileName) endswith "appvshnotify.exe" and tolower(InitiatingProcessFileName) endswith "bdeuisrv.exe" and tolower(InitiatingProcessFileName) endswith "colorcpl.exe" and tolower(InitiatingProcessFileName) endswith "customshellhost.exe" and tolower(InitiatingProcessFileName) endswith "dccw.exe" and tolower(InitiatingProcessFileName) endswith "deviceenroller.exe" and tolower(InitiatingProcessFileName) endswith "dmomacpmo.exe" and tolower(InitiatingProcessFileName) endswith "dsregcmd.exe" and tolower(InitiatingProcessFileName) endswith "efsui.exe" and tolower(InitiatingProcessFileName) endswith "gpupdate.exe" and tolower(InitiatingProcessFileName) endswith "mdmappinstaller.exe" and tolower(InitiatingProcessFileName) endswith "mdmdiagnosticstool.exe" and tolower(InitiatingProcessFileName) endswith "microsoftedgebchost.exe" and tolower(InitiatingProcessFileName) endswith "microsoftedgecp.exe" and tolower(InitiatingProcessFileName) endswith "microsoftedgesh.exe" and tolower(InitiatingProcessFileName) endswith "mrt.exe" and tolower(InitiatingProcessFileName) endswith "msra.exe" and tolower(InitiatingProcessFileName) endswith "musnotification.exe" and tolower(InitiatingProcessFileName) endswith "musnotificationux.exe" and tolower(InitiatingProcessFileName) endswith "netsh.exe" and tolower(InitiatingProcessFileName) endswith "omadmclient.exe" and tolower(InitiatingProcessFileName) endswith "proquota.exe" and tolower(InitiatingProcessFileName) endswith "rekeywiz.exe" and tolower(InitiatingProcessFileName) endswith "runexehelper.exe" and tolower(InitiatingProcessFileName) endswith "securityhealthservice.exe" and tolower(InitiatingProcessFileName) endswith "settingsynchost.exe" and tolower(InitiatingProcessFileName) endswith "systemsettingsadminflows.exe" and tolower(InitiatingProcessFileName) endswith "tttracer.exe" and tolower(InitiatingProcessFileName) endswith "utcdecoderhost.exe" and tolower(InitiatingProcessFileName) endswith "vaultcmd.exe" and tolower(InitiatingProcessFileName) endswith "workfolders.exe" and tolower(InitiatingProcessFileName) endswith "wpcmon.exe")
| where tolower(FileName) == "utildll.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "change.exe" and tolower(InitiatingProcessFileName) endswith "chglogon.exe" and tolower(InitiatingProcessFileName) endswith "chgport.exe" and tolower(InitiatingProcessFileName) endswith "query.exe" and tolower(InitiatingProcessFileName) endswith "quser.exe" and tolower(InitiatingProcessFileName) endswith "qprocess.exe" and tolower(InitiatingProcessFileName) endswith "qwinsta.exe" and tolower(InitiatingProcessFileName) endswith "reset.exe" and tolower(InitiatingProcessFileName) endswith "rwinsta.exe" and tolower(InitiatingProcessFileName) endswith "tscon.exe" and tolower(InitiatingProcessFileName) endswith "tskill.exe")
| where tolower(FileName) == "uxinit.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "winlogon.exe")
| where tolower(FileName) == "uxtheme.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "atbroker.exe" and tolower(InitiatingProcessFileName) endswith "cloudnotifications.exe" and tolower(InitiatingProcessFileName) endswith "cttune.exe" and tolower(InitiatingProcessFileName) endswith "displayswitch.exe" and tolower(InitiatingProcessFileName) endswith "ehstorauthn.exe" and tolower(InitiatingProcessFileName) endswith "filehistory.exe" and tolower(InitiatingProcessFileName) endswith "gamepanel.exe" and tolower(InitiatingProcessFileName) endswith "isoburn.exe" and tolower(InitiatingProcessFileName) endswith "mblctr.exe" and tolower(InitiatingProcessFileName) endswith "mmc.exe" and tolower(InitiatingProcessFileName) endswith "msdt.exe" and tolower(InitiatingProcessFileName) endswith "msra.exe" and tolower(InitiatingProcessFileName) endswith "musnotifyicon.exe" and tolower(InitiatingProcessFileName) endswith "passwordonwakesettingflyout.exe" and tolower(InitiatingProcessFileName) endswith "quickassist.exe" and tolower(InitiatingProcessFileName) endswith "recoverydrive.exe" and tolower(InitiatingProcessFileName) endswith "sdclt.exe" and tolower(InitiatingProcessFileName) endswith "sethc.exe" and tolower(InitiatingProcessFileName) endswith "sndvol.exe" and tolower(InitiatingProcessFileName) endswith "snippingtool.exe" and tolower(InitiatingProcessFileName) endswith "taskmgr.exe" and tolower(InitiatingProcessFileName) endswith "wfs.exe" and tolower(InitiatingProcessFileName) endswith "wiaacmgr.exe" and tolower(InitiatingProcessFileName) endswith "wiawow64.exe" and tolower(InitiatingProcessFileName) endswith "wmpdmc.exe")
| where tolower(FileName) == "vaultcli.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "cipher.exe" and tolower(InitiatingProcessFileName) endswith "efsui.exe" and tolower(InitiatingProcessFileName) endswith "rekeywiz.exe" and tolower(InitiatingProcessFileName) endswith "vaultcmd.exe")
| where tolower(FileName) == "vdsutil.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "vdsldr.exe")
| where tolower(FileName) == "version.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "agentservice.exe" and tolower(InitiatingProcessFileName) endswith "certutil.exe" and tolower(InitiatingProcessFileName) endswith "choice.exe" and tolower(InitiatingProcessFileName) endswith "clip.exe" and tolower(InitiatingProcessFileName) endswith "cmstp.exe" and tolower(InitiatingProcessFileName) endswith "cofire.exe" and tolower(InitiatingProcessFileName) endswith "cscript.exe" and tolower(InitiatingProcessFileName) endswith "diskpart.exe" and tolower(InitiatingProcessFileName) endswith "diskraid.exe" and tolower(InitiatingProcessFileName) endswith "dism.exe" and tolower(InitiatingProcessFileName) endswith "driverquery.exe" and tolower(InitiatingProcessFileName) endswith "forfiles.exe" and tolower(InitiatingProcessFileName) endswith "fxssvc.exe" and tolower(InitiatingProcessFileName) endswith "ie4ushowie.exe" and tolower(InitiatingProcessFileName) endswith "iexpress.exe" and tolower(InitiatingProcessFileName) endswith "msconfig.exe" and tolower(InitiatingProcessFileName) endswith "mstsc.exe" and tolower(InitiatingProcessFileName) endswith "openfiles.exe" and tolower(InitiatingProcessFileName) endswith "presentationhost.exe" and tolower(InitiatingProcessFileName) endswith "psr.exe" and tolower(InitiatingProcessFileName) endswith "relpost.exe" and tolower(InitiatingProcessFileName) endswith "sfc.exe" and tolower(InitiatingProcessFileName) endswith "sigverif.exe" and tolower(InitiatingProcessFileName) endswith "systeminfo.exe" and tolower(InitiatingProcessFileName) endswith "taskkill.exe" and tolower(InitiatingProcessFileName) endswith "tasklist.exe" and tolower(InitiatingProcessFileName) endswith "timeout.exe" and tolower(InitiatingProcessFileName) endswith "unregmp2.exe" and tolower(InitiatingProcessFileName) endswith "verifiergui.exe" and tolower(InitiatingProcessFileName) endswith "vsgraphicsdesktopengine.exe" and tolower(InitiatingProcessFileName) endswith "waitfor.exe" and tolower(InitiatingProcessFileName) endswith "wextract.exe" and tolower(InitiatingProcessFileName) endswith "where.exe" and tolower(InitiatingProcessFileName) endswith "whoami.exe" and tolower(InitiatingProcessFileName) endswith "winsat.exe" and tolower(InitiatingProcessFileName) endswith "wscript.exe" and tolower(InitiatingProcessFileName) endswith "zoom.exe")
| where tolower(FileName) == "virtdisk.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "bootim.exe" and tolower(InitiatingProcessFileName) endswith "vssvc.exe" and tolower(InitiatingProcessFileName) endswith "wbengine.exe")
| where tolower(FileName) == "vssapi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "bootim.exe" and tolower(InitiatingProcessFileName) endswith "cleanmgr.exe" and tolower(InitiatingProcessFileName) endswith "dsdbutil.exe" and tolower(InitiatingProcessFileName) endswith "ntdsutil.exe" and tolower(InitiatingProcessFileName) endswith "recoverydrive.exe" and tolower(InitiatingProcessFileName) endswith "resetengine.exe" and tolower(InitiatingProcessFileName) endswith "rstrui.exe" and tolower(InitiatingProcessFileName) endswith "sdclt.exe" and tolower(InitiatingProcessFileName) endswith "srtasks.exe" and tolower(InitiatingProcessFileName) endswith "systemreset.exe" and tolower(InitiatingProcessFileName) endswith "vssadmin.exe" and tolower(InitiatingProcessFileName) endswith "vssvc.exe" and tolower(InitiatingProcessFileName) endswith "wbengine.exe" and tolower(InitiatingProcessFileName) endswith "avshadow.exe")
| where tolower(FileName) == "vsstrace.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "bootim.exe" and tolower(InitiatingProcessFileName) endswith "resetengine.exe" and tolower(InitiatingProcessFileName) endswith "rstrui.exe" and tolower(InitiatingProcessFileName) endswith "sdclt.exe" and tolower(InitiatingProcessFileName) endswith "srtasks.exe" and tolower(InitiatingProcessFileName) endswith "systemreset.exe" and tolower(InitiatingProcessFileName) endswith "vssadmin.exe" and tolower(InitiatingProcessFileName) endswith "vssvc.exe" and tolower(InitiatingProcessFileName) endswith "wbengine.exe")
| where tolower(FileName) == "wbemprox.dll" and (tolower(FolderPath) !contains "c:\windows\system32\wbem" and tolower(FolderPath) !contains "c:\windows\syswow64\wbem")
| where tolower(FileName) == "wbemsvc.dll" and (tolower(FolderPath) !contains "c:\windows\system32\wbem" and tolower(FolderPath) !contains "c:\windows\syswow64\wbem")
| where tolower(FileName) == "wcmapi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "netsh.exe")
| where tolower(FileName) == "wcnnetsh.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(InitiatingProcessFileName) endswith "netsh.exe")
| where tolower(FileName) == "wdi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "cofire.exe" and tolower(InitiatingProcessFileName) endswith "msra.exe" and tolower(InitiatingProcessFileName) endswith "netsh.exe")
| where tolower(FileName) == "wdscore.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "bootim.exe" and tolower(InitiatingProcessFileName) endswith "deploymentcsphelper.exe" and tolower(InitiatingProcessFileName) endswith "djoin.exe" and tolower(InitiatingProcessFileName) endswith "dnscacheugc.exe" and tolower(InitiatingProcessFileName) endswith "muiunattend.exe" and tolower(InitiatingProcessFileName) endswith "netbtugc.exe" and tolower(InitiatingProcessFileName) endswith "netiougc.exe" and tolower(InitiatingProcessFileName) endswith "pnpunattend.exe" and tolower(InitiatingProcessFileName) endswith "recoverydrive.exe" and tolower(InitiatingProcessFileName) endswith "resetengine.exe" and tolower(InitiatingProcessFileName) endswith "setupugc.exe" and tolower(InitiatingProcessFileName) endswith "sysreseterr.exe" and tolower(InitiatingProcessFileName) endswith "systemreset.exe" and tolower(InitiatingProcessFileName) endswith "tapiunattend.exe" and tolower(InitiatingProcessFileName) endswith "ieunatt.exe")
| where tolower(FileName) == "webservices.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "clipup.exe" and tolower(InitiatingProcessFileName) endswith "sppsvc.exe" and tolower(InitiatingProcessFileName) endswith "vsgraphicsdesktopengine.exe" and tolower(InitiatingProcessFileName) endswith "vsgraphicsremoteengine.exe" and tolower(InitiatingProcessFileName) endswith "wifitask.exe" and tolower(InitiatingProcessFileName) endswith "wksprt.exe")
| where tolower(FileName) == "wecapi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "wecutil.exe")
| where tolower(FileName) == "wer.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "dwwin.exe" and tolower(InitiatingProcessFileName) endswith "msdt.exe" and tolower(InitiatingProcessFileName) endswith "pcalua.exe" and tolower(InitiatingProcessFileName) endswith "relpost.exe" and tolower(InitiatingProcessFileName) endswith "rstrui.exe" and tolower(InitiatingProcessFileName) endswith "sdclt.exe" and tolower(InitiatingProcessFileName) endswith "srtasks.exe" and tolower(InitiatingProcessFileName) endswith "wbengine.exe" and tolower(InitiatingProcessFileName) endswith "werfault.exe" and tolower(InitiatingProcessFileName) endswith "werfaultsecure.exe" and tolower(InitiatingProcessFileName) endswith "wermgr.exe")
| where tolower(FileName) == "wevtapi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "cidiag.exe" and tolower(InitiatingProcessFileName) endswith "dcdiag.exe" and tolower(InitiatingProcessFileName) endswith "gpupdate.exe" and tolower(InitiatingProcessFileName) endswith "mbaeparsertask.exe" and tolower(InitiatingProcessFileName) endswith "netsh.exe" and tolower(InitiatingProcessFileName) endswith "nlb.exe" and tolower(InitiatingProcessFileName) endswith "packageinspector.exe" and tolower(InitiatingProcessFileName) endswith "plasrv.exe" and tolower(InitiatingProcessFileName) endswith "tracerpt.exe" and tolower(InitiatingProcessFileName) endswith "wecutil.exe" and tolower(InitiatingProcessFileName) endswith "wlbs.exe" and tolower(InitiatingProcessFileName) endswith "wsreset.exe")
| where tolower(FileName) == "whhelper.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "netsh.exe")
| where tolower(FileName) == "wimgapi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(FolderPath) !contains "c:\program files\windows kits\10\assessment and deployment kit\deployment tools\arm64\dism" and tolower(InitiatingProcessFileName) endswith "recoverydrive.exe" and tolower(InitiatingProcessFileName) endswith "resetengine.exe" and tolower(InitiatingProcessFileName) endswith "systemreset.exe")
| where tolower(FileName) == "winbio.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "securityhealthservice.exe")
| where tolower(FileName) == "winbrand.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "bdehdcfg.exe" and tolower(InitiatingProcessFileName) endswith "licensediag.exe" and tolower(InitiatingProcessFileName) endswith "slui.exe" and tolower(InitiatingProcessFileName) endswith "systempropertiesadvanced.exe" and tolower(InitiatingProcessFileName) endswith "systemsettingsadminflows.exe")
| where tolower(FileName) == "windows.storage.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "windows.storage.search.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "windows.ui.immersive.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "dmnotificationbroker.exe" and tolower(InitiatingProcessFileName) endswith "phoneactivate.exe")
| where tolower(FileName) == "windowscodecs.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "certreq.exe" and tolower(InitiatingProcessFileName) endswith "osk.exe" and tolower(InitiatingProcessFileName) endswith "quickassist.exe" and tolower(InitiatingProcessFileName) endswith "wmpdmc.exe")
| where tolower(FileName) == "windowscodecsext.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "windowsperformancerecordercontrol.dll" and (tolower(FolderPath) !contains "c:\program files\windows kits\10\windows performance toolkit" and tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "wpr.exe")
| where tolower(FileName) == "windowsudk.shellcommon.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "winhttp.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "cmdl32.exe" and tolower(InitiatingProcessFileName) endswith "devicecensus.exe" and tolower(InitiatingProcessFileName) endswith "dmclient.exe" and tolower(InitiatingProcessFileName) endswith "dsregcmd.exe" and tolower(InitiatingProcessFileName) endswith "mdmdiagnosticstool.exe" and tolower(InitiatingProcessFileName) endswith "msdt.exe" and tolower(InitiatingProcessFileName) endswith "mshta.exe" and tolower(InitiatingProcessFileName) endswith "mstsc.exe" and tolower(InitiatingProcessFileName) endswith "musnotification.exe" and tolower(InitiatingProcessFileName) endswith "musnotificationux.exe" and tolower(InitiatingProcessFileName) endswith "musnotifyicon.exe" and tolower(InitiatingProcessFileName) endswith "netsh.exe" and tolower(InitiatingProcessFileName) endswith "pacjsworker.exe" and tolower(InitiatingProcessFileName) endswith "recoverydrive.exe" and tolower(InitiatingProcessFileName) endswith "resetengine.exe" and tolower(InitiatingProcessFileName) endswith "rpcping.exe" and tolower(InitiatingProcessFileName) endswith "sgrmlpac.exe" and tolower(InitiatingProcessFileName) endswith "sihclient.exe" and tolower(InitiatingProcessFileName) endswith "systemreset.exe" and tolower(InitiatingProcessFileName) endswith "wkspbroker.exe" and tolower(InitiatingProcessFileName) endswith "minecraftlauncher.exe")
| where tolower(FileName) == "wininet.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "appvclient.exe" and tolower(InitiatingProcessFileName) endswith "browserexport.exe" and tolower(InitiatingProcessFileName) endswith "calc.exe" and tolower(InitiatingProcessFileName) endswith "certreq.exe" and tolower(InitiatingProcessFileName) endswith "computerdefaults.exe" and tolower(InitiatingProcessFileName) endswith "dsregcmd.exe" and tolower(InitiatingProcessFileName) endswith "fodhelper.exe" and tolower(InitiatingProcessFileName) endswith "ie4uinit.exe" and tolower(InitiatingProcessFileName) endswith "logagent.exe" and tolower(InitiatingProcessFileName) endswith "mdmdiagnosticstool.exe" and tolower(InitiatingProcessFileName) endswith "mstsc.exe" and tolower(InitiatingProcessFileName) endswith "presentationhost.exe" and tolower(InitiatingProcessFileName) endswith "quickassist.exe" and tolower(InitiatingProcessFileName) endswith "tokenbrokercookies.exe" and tolower(InitiatingProcessFileName) endswith "wkspbroker.exe" and tolower(InitiatingProcessFileName) endswith "wksprt.exe")
| where tolower(FileName) == "winipsec.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "netsh.exe")
| where tolower(FileName) == "winmde.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(InitiatingProcessFileName) endswith "mdeserver.exe")
| where tolower(FileName) == "winmm.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "mblctr.exe" and tolower(InitiatingProcessFileName) endswith "mspaint.exe" and tolower(InitiatingProcessFileName) endswith "mstsc.exe" and tolower(InitiatingProcessFileName) endswith "osk.exe" and tolower(InitiatingProcessFileName) endswith "presentationsettings.exe" and tolower(InitiatingProcessFileName) endswith "proximityuxhost.exe" and tolower(InitiatingProcessFileName) endswith "wfs.exe" and tolower(InitiatingProcessFileName) endswith "winsat.exe")
| where tolower(FileName) == "winnsi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "netsh.exe")
| where tolower(FileName) == "winrnr.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "winscard.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "immersivetpmvscmgrsvr.exe" and tolower(InitiatingProcessFileName) endswith "rmttpmvscmgrsvr.exe" and tolower(InitiatingProcessFileName) endswith "tpmvscmgrsvr.exe")
| where tolower(FileName) == "winsqlite3.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "browserexport.exe" and tolower(InitiatingProcessFileName) endswith "mousocoreworker.exe")
| where tolower(FileName) == "winsta.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "change.exe" and tolower(InitiatingProcessFileName) endswith "chglogon.exe" and tolower(InitiatingProcessFileName) endswith "chgport.exe" and tolower(InitiatingProcessFileName) endswith "ctfmon.exe" and tolower(InitiatingProcessFileName) endswith "displayswitch.exe" and tolower(InitiatingProcessFileName) endswith "msg.exe" and tolower(InitiatingProcessFileName) endswith "musnotification.exe" and tolower(InitiatingProcessFileName) endswith "query.exe" and tolower(InitiatingProcessFileName) endswith "quser.exe" and tolower(InitiatingProcessFileName) endswith "qprocess.exe" and tolower(InitiatingProcessFileName) endswith "qwinsta.exe" and tolower(InitiatingProcessFileName) endswith "rdpclip.exe" and tolower(InitiatingProcessFileName) endswith "rdpinput.exe" and tolower(InitiatingProcessFileName) endswith "rdpsa.exe" and tolower(InitiatingProcessFileName) endswith "rdpsauachelper.exe" and tolower(InitiatingProcessFileName) endswith "rdpshell.exe" and tolower(InitiatingProcessFileName) endswith "rdvghelper.exe" and tolower(InitiatingProcessFileName) endswith "reset.exe" and tolower(InitiatingProcessFileName) endswith "rwinsta.exe" and tolower(InitiatingProcessFileName) endswith "systempropertiesadvanced.exe" and tolower(InitiatingProcessFileName) endswith "systempropertiescomputername.exe" and tolower(InitiatingProcessFileName) endswith "systempropertiesdataexecutionprevention.exe" and tolower(InitiatingProcessFileName) endswith "systempropertieshardware.exe" and tolower(InitiatingProcessFileName) endswith "systempropertiesprotection.exe" and tolower(InitiatingProcessFileName) endswith "systempropertiesremote.exe" and tolower(InitiatingProcessFileName) endswith "tscon.exe" and tolower(InitiatingProcessFileName) endswith "tsdiscon.exe" and tolower(InitiatingProcessFileName) endswith "tskill.exe" and tolower(InitiatingProcessFileName) endswith "igfxsdk.exe")
| where tolower(FileName) == "winsync.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "synchost.exe")
| where tolower(FileName) == "wkscli.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "djoin.exe" and tolower(InitiatingProcessFileName) endswith "dsregcmd.exe" and tolower(InitiatingProcessFileName) endswith "edpcleanup.exe" and tolower(InitiatingProcessFileName) endswith "getmac.exe" and tolower(InitiatingProcessFileName) endswith "ie4uinit.exe" and tolower(InitiatingProcessFileName) endswith "mshta.exe" and tolower(InitiatingProcessFileName) endswith "mstsc.exe" and tolower(InitiatingProcessFileName) endswith "net.exe" and tolower(InitiatingProcessFileName) endswith "net1.exe" and tolower(InitiatingProcessFileName) endswith "netdom.exe" and tolower(InitiatingProcessFileName) endswith "secinit.exe" and tolower(InitiatingProcessFileName) endswith "systempropertiesadvanced.exe" and tolower(InitiatingProcessFileName) endswith "systemsettingsadminflows.exe" and tolower(InitiatingProcessFileName) endswith "whoami.exe")
| where tolower(FileName) == "wlanapi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "legacynetuxhost.exe" and tolower(InitiatingProcessFileName) endswith "netsh.exe" and tolower(InitiatingProcessFileName) endswith "wifitask.exe")
| where tolower(FileName) == "wlancfg.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "netsh.exe")
| where tolower(FileName) == "wldp.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "mshta.exe" and tolower(InitiatingProcessFileName) endswith "securityhealthservice.exe" and tolower(InitiatingProcessFileName) endswith "systemsettingsadminflows.exe" and tolower(InitiatingProcessFileName) endswith "write.exe")
| where tolower(FileName) == "wlidprov.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "wmiclnt.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "dispdiag.exe" and tolower(InitiatingProcessFileName) endswith "iscsicli.exe")
| where tolower(FileName) == "wmidcom.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "wmiutils.dll" and (tolower(FolderPath) !contains "c:\windows\system32\wbem" and tolower(FolderPath) !contains "c:\windows\syswow64\wbem")
| where tolower(FileName) == "wmpdui.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(InitiatingProcessFileName) endswith "wmpdmc.exe")
| where tolower(FileName) == "wmsgapi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "osk.exe")
| where tolower(FileName) == "wofutil.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "recoverydrive.exe" and tolower(InitiatingProcessFileName) endswith "resetengine.exe" and tolower(InitiatingProcessFileName) endswith "systemreset.exe")
| where tolower(FileName) == "wpdshext.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "wscapi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "wscadminui.exe")
| where tolower(FileName) == "wsdapi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "wsddebug_host.exe")
| where tolower(FileName) == "wshbth.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "wshelper.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "netsh.exe")
| where tolower(FileName) == "wsmsvc.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "winrs.exe" and tolower(InitiatingProcessFileName) endswith "wsmanhttpconfig.exe" and tolower(InitiatingProcessFileName) endswith "wsmprovhost.exe")
| where tolower(FileName) == "wtsapi32.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "appvclient.exe" and tolower(InitiatingProcessFileName) endswith "bdeuisrv.exe" and tolower(InitiatingProcessFileName) endswith "customshellhost.exe" and tolower(InitiatingProcessFileName) endswith "magnify.exe" and tolower(InitiatingProcessFileName) endswith "mblctr.exe" and tolower(InitiatingProcessFileName) endswith "mdmappinstaller.exe" and tolower(InitiatingProcessFileName) endswith "raserver.exe" and tolower(InitiatingProcessFileName) endswith "rdpclip.exe" and tolower(InitiatingProcessFileName) endswith "rdpinput.exe" and tolower(InitiatingProcessFileName) endswith "rdpshell.exe" and tolower(InitiatingProcessFileName) endswith "rdvghelper.exe" and tolower(InitiatingProcessFileName) endswith "sdclt.exe" and tolower(InitiatingProcessFileName) endswith "securityhealthservice.exe" and tolower(InitiatingProcessFileName) endswith "sethc.exe" and tolower(InitiatingProcessFileName) endswith "slui.exe" and tolower(InitiatingProcessFileName) endswith "systemsettingsadminflows.exe" and tolower(InitiatingProcessFileName) endswith "wusa.exe")
| where tolower(FileName) == "wwancfg.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "netsh.exe")
| where tolower(FileName) == "wwapi.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "netsh.exe")
| where tolower(FileName) == "xmllite.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "certreq.exe" and tolower(InitiatingProcessFileName) endswith "ddodiag.exe" and tolower(InitiatingProcessFileName) endswith "deviceenroller.exe" and tolower(InitiatingProcessFileName) endswith "dmcfghost.exe" and tolower(InitiatingProcessFileName) endswith "dmclient.exe" and tolower(InitiatingProcessFileName) endswith "dmomacpmo.exe" and tolower(InitiatingProcessFileName) endswith "dxcap.exe" and tolower(InitiatingProcessFileName) endswith "dxpserver.exe" and tolower(InitiatingProcessFileName) endswith "mdmdiagnosticstool.exe" and tolower(InitiatingProcessFileName) endswith "mousocoreworker.exe" and tolower(InitiatingProcessFileName) endswith "musnotificationux.exe" and tolower(InitiatingProcessFileName) endswith "musnotifyicon.exe" and tolower(InitiatingProcessFileName) endswith "omadmclient.exe" and tolower(InitiatingProcessFileName) endswith "psr.exe" and tolower(InitiatingProcessFileName) endswith "resetengine.exe" and tolower(InitiatingProcessFileName) endswith "sppsvc.exe" and tolower(InitiatingProcessFileName) endswith "systemreset.exe" and tolower(InitiatingProcessFileName) endswith "tracerpt.exe" and tolower(InitiatingProcessFileName) endswith "upfc.exe" and tolower(InitiatingProcessFileName) endswith "usocoreworker.exe" and tolower(InitiatingProcessFileName) endswith "vsgraphicsdesktopengine.exe" and tolower(InitiatingProcessFileName) endswith "vsgraphicsremoteengine.exe" and tolower(InitiatingProcessFileName) endswith "wbengine.exe" and tolower(InitiatingProcessFileName) endswith "inputpersonalization.exe")
| where tolower(FileName) == "xolehlp.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "msdtc.exe")
| where tolower(FileName) == "xpsservices.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(InitiatingProcessFileName) endswith "printfilterpipelinesvc.exe")
| where tolower(FileName) == "xwizards.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "xwtpw32.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64")
| where tolower(FileName) == "atltracetoolui.dll" and (tolower(FolderPath) !contains "c:\program files\microsoft visual studio 11.0\common7\tools" and tolower(InitiatingProcessFileName) endswith "atltracetool8.exe")
| where tolower(FileName) == "dbgeng.dll" and (tolower(FolderPath) !contains "c:\program files\windows kits\\debuggers\x86" and tolower(FolderPath) !contains "c:\program files\windows kits\\debuggers\x64" and tolower(FolderPath) !contains "c:\program files\windows kits\\debuggers\arm" and tolower(FolderPath) !contains "c:\program files\windows kits\\debuggers\arm64" and tolower(InitiatingProcessFileName) endswith "windbg.exe")
| where tolower(FileName) == "formdll.dll" and (tolower(FolderPath) !contains "c:\program files\common files\microsoft shared\notesync forms" and tolower(InitiatingProcessFileName) endswith "inkform.exe")
| where tolower(FileName) == "gflagsui.dll" and (tolower(FolderPath) !contains "c:\program files\windows kits\10\debuggers\" and tolower(InitiatingProcessFileName) endswith "gflags.exe")
| where tolower(FileName) == "hha.dll" and (tolower(FolderPath) !contains "c:\windows\system32" and tolower(FolderPath) !contains "c:\windows\syswow64" and tolower(FolderPath) !contains "c:\program files\html help workshop" and tolower(InitiatingProcessFileName) endswith "hhc.exe")
| where tolower(FileName) == "iviewers.dll" and (tolower(FolderPath) !contains "c:\program files\windows kits\10\bin\\x86" and tolower(FolderPath) !contains "c:\program files\windows kits\10\bin\\x64" and tolower(FolderPath) !contains "c:\program files\windows kits\10\bin\\arm" and tolower(FolderPath) !contains "c:\program files\windows kits\10\bin\\arm64" and tolower(InitiatingProcessFileName) endswith "oleview.exe" and tolower(InitiatingProcessFileName) endswith "oleview.exe" and tolower(InitiatingProcessFileName) endswith "oleview.exe")
| where tolower(FileName) == "outllib.dll" and (tolower(FolderPath) !contains "c:\program files\microsoft office\office" and tolower(FolderPath) !contains "c:\program files\microsoft office\root\office" and tolower(InitiatingProcessFileName) endswith "outlook.exe" and tolower(InitiatingProcessFileName) endswith "outlook.exe")
| where tolower(FileName) == "rcdll.dll" and (tolower(FolderPath) !contains "c:\program files\windows kits\10\bin\\" and tolower(InitiatingProcessFileName) endswith "rc.exe")
| where tolower(FileName) == "symsrv.dll" and (tolower(FolderPath) !contains "c:\program files\windows kits\10\debuggers\" and tolower(InitiatingProcessFileName) endswith "symstore.exe")
| where tolower(FileName) == "windowsperformancerecorderui.dll" and (tolower(FolderPath) !contains "c:\program files\windows kits\10\windows performance toolkit" and tolower(InitiatingProcessFileName) endswith "wprui.exe")